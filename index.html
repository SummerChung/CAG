<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>合約自動化生成</title>
    
    <script src="https://unpkg.com/pizzip@3.1.4/dist/pizzip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.37.11/docxtemplater.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>

    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f4f4f4; padding: 20px; }
        .container { max-width: 950px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h2 { border-bottom: 2px solid #333; padding-bottom: 10px; }
        h3 { color: #0056b3; margin-top: 25px; margin-bottom: 10px; }
        
        .page { display: none; }
        .page.active { display: block; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        
        input[type="text"], input[type="number"], select, textarea { 
            width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px; 
        }
        
        input[type="radio"], input[type="checkbox"] {
            width: auto; margin-right: 8px; transform: scale(1.2); cursor: pointer;
        }

        select.inline-select { width: auto; padding: 4px; margin: 0 5px; }
        .row { display: flex; gap: 10px; } .col { flex: 1; }
        .btn-group { margin-top: 20px; text-align: right; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button.secondary { background-color: #6c757d; } button.success { background-color: #28a745; }
        
        /* 表格樣式設定 */
        .table-input { width: 100%; border-collapse: collapse; margin-bottom: 15px; table-layout: fixed; }
        .table-input th, .table-input td { border: 1px solid #ddd; padding: 8px; text-align: center; vertical-align: middle; }
        .table-input th { background-color: #f8f9fa; font-weight: bold; color: #333; }
        .table-input input { text-align: center; }

        .checkbox-group-row { display: flex; align-items: center; gap: 25px; }
        .checkbox-group-col { display: flex; flex-direction: column; gap: 12px; }
        .checkbox-group-row label, .checkbox-group-col label { display: flex; align-items: center; font-weight: normal; cursor: pointer; margin: 0; }

        .hidden { display: none; }
        .indent { margin-left: 28px; margin-top: 5px; border-left: 2px solid #eee; padding-left: 10px; } 
        .required-mark { color: red; margin-left: 3px; }
    </style>
</head>
<body>

<div class="container">
    <h1>合約自動化生成</h1>
    
    <!-- 第一頁 -->
    <div id="page1" class="page active">
        <h2>步驟 1/2：基本資料與費用</h2>
        
        <h3>1. 合約類型</h3>
        <div class="form-group">
            <div class="checkbox-group-row">
                <label><input type="radio" name="contractType" value="new"> 新簽約</label>
                <label><input type="radio" name="contractType" value="renew" checked> 續約</label>
            </div>
        </div>

        <h3>2. 合約期間 <span class="required-mark">*</span></h3>
        <div class="row">
            <div class="col">
                <label>起始日期</label>
                <div class="row">
                    <select id="startYear" onchange="calcDuration()"><option value="">年</option></select>
                    <select id="startMonth" onchange="calcDuration()"><option value="">月</option></select>
                    <select id="startDay" onchange="calcDuration()"><option value="">日</option></select>
                </div>
            </div>
            <div class="col">
                <label>結束日期</label>
                <div class="row">
                    <select id="endYear" onchange="calcDuration()"><option value="">年</option></select>
                    <select id="endMonth" onchange="calcDuration()"><option value="">月</option></select>
                    <select id="endDay" onchange="calcDuration()"><option value="">日</option></select>
                </div>
            </div>
        </div>
        <div class="form-group"><label>期間計算結果</label><input type="text" id="durationResult" readonly style="background:#e9ecef;"></div>
        <div class="form-group">
            <label>封底日期 <span style="color:blue;font-weight:bold;">(預設今日)</span></label>
            <div class="row" style="max-width:400px;"><select id="coverYear"></select><select id="coverMonth"></select><select id="coverDay"></select></div>
        </div>

        <h3>3. 基本資料</h3>
        <div class="row"><div class="col"><label>社區名稱 <span class="required-mark">*</span></label><input type="text" id="commName" required></div><div class="col"><label>地址 <span class="required-mark">*</span></label><input type="text" id="commAddr" required></div></div>
        <div class="row"><div class="col"><label>乙方 <span class="required-mark">*</span></label><input type="text" id="partyB" required></div><div class="col"><label>代表人 <span class="required-mark">*</span></label><input type="text" id="repName" required></div></div>
        <div class="row"><div class="col"><label>電話 <span class="required-mark">*</span></label><input type="text" id="phone" required></div><div class="col"><label>統一編號</label><input type="text" id="taxId"></div></div>

        <h3>4. 設備與費用 <span class="required-mark">*</span></h3>
        <table class="table-input">
            <thead>
                <tr>
                    <th width="20%">項目</th>
                    <th width="15%">數量</th>
                    <th width="25%">位置</th>
                    <th width="15%">單價</th>
                    <th width="25%">小計</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>社區EIP聯網機 (序1)</td>
                    <td><input type="number" id="qty_eip_net_1" onchange="calcFees()"></td>
                    <td><input type="text" id="loc_eip_net_1" value="電梯內，壹部電梯安裝壹台設備。"></td>
                    <td><input type="number" id="price_eip_net_1" onchange="calcFees()"></td>
                    <td><input type="text" id="sub_eip_net_1" readonly></td>
                </tr>
                <tr>
                    <td>社區EIP聯網機 (序2)</td>
                    <td><input type="number" id="qty_eip_net_2" onchange="calcFees()"></td>
                    <td><input type="text" id="loc_eip_net_2" value="一樓梯廳。"></td>
                    <td><input type="number" id="price_eip_net_2" onchange="calcFees()"></td>
                    <td><input type="text" id="sub_eip_net_2" readonly></td>
                </tr>
                <tr>
                    <td>社區EIP公告機 (序3)</td>
                    <td><input type="number" id="qty_eip_anno" onchange="calcFees()"></td>
                    <!-- 預設留空 -->
                    <td><input type="text" id="loc_eip_anno"></td>
                    <td><input type="number" id="price_eip_anno" onchange="calcFees()"></td>
                    <td><input type="text" id="sub_eip_anno" readonly></td>
                </tr>
                <tr>
                    <td colspan="4" style="text-align:right;font-weight:bold;">合計(月)</td>
                    <td><input type="text" id="total_monthly" readonly style="color:red;font-weight:bold;"></td>
                </tr>
            </tbody>
        </table>

        <h3>5. 匯款資料</h3>
        <div class="row">
            <div class="col">
                <label>銀行 <span class="required-mark">*</span></label>
                <input type="text" id="bankName" list="bankList" placeholder="請輸入代碼或名稱搜尋" required>
                <datalist id="bankList"></datalist>
            </div>
            <div class="col">
                <label>分行 <span class="required-mark">*</span></label>
                <input type="text" id="bankBranch" list="branchList" placeholder="請先選擇銀行" required>
                <datalist id="branchList"></datalist>
            </div>
        </div>
        <div class="row">
            <div class="col"><label>戶名 <span class="required-mark">*</span></label><input type="text" id="acctName" required></div>
            <div class="col"><label>帳號 <span class="required-mark">*</span></label><input type="text" id="acctNum" required></div>
        </div>
        
        <div class="btn-group">
            <button onclick="nextPage(2)">下一步 &gt;</button>
        </div>
    </div>

    <!-- 第二頁 -->
    <div id="page2" class="page">
        <h2>步驟 2/2：條款勾選與生成</h2>
        
        <div class="form-group">
            <label>1. 到期處理方式</label>
            <div class="checkbox-group-col">
                <label>
                    <input type="radio" name="expiryOpt" value="1" checked> 
                    自動延展 
                    <select id="renewalYear" class="inline-select" onclick="event.stopPropagation()">
                        <option value="壹">壹</option>
                        <option value="貳">貳</option>
                        <option value="參">參</option>
                        <option value="肆">肆</option>
                        <option value="伍">伍</option>
                    </select> 
                    年
                </label>
                <label>
                    <input type="radio" name="expiryOpt" value="2"> 須重簽合約
                </label>
            </div>
        </div>

        <div class="form-group">
            <label>2. 通知方式</label>
            <div class="checkbox-group-col">
                <label><input type="checkbox" id="notify_line"> Line@</label>
                <label><input type="checkbox" id="notify_paper"> 書面</label>
                <label><input type="checkbox" id="notify_screen"> 屏幕</label>
                
                <label><input type="checkbox" id="notify_email" onchange="toggleEmailInput()"> Email</label>
                <div id="emailInputArea" class="hidden indent">
                    <div class="row" style="margin-bottom: 10px;">
                        <input type="text" id="mail_name_a" placeholder="甲方姓名">
                        <input type="text" id="mail_addr_a" placeholder="甲方Email">
                    </div>
                    <div class="row">
                        <input type="text" id="mail_name_b" placeholder="乙方姓名">
                        <input type="text" id="mail_addr_b" placeholder="乙方Email">
                    </div>
                </div>
                
                <label><input type="checkbox" id="notify_other" onchange="toggleOtherInput()"> 其他</label>
                <div id="otherInputArea" class="hidden indent"><input type="text" id="other_social_text" placeholder="軟體名稱"></div>
            </div>
        </div>
        
        <div class="form-group">
            <label>3. 特別約定事項</label>
            <div class="checkbox-group-col">
                <label><input type="radio" name="specialOpt" value="1" checked onchange="toggleSpecialInput()"> 無</label>
                <label><input type="radio" name="specialOpt" value="2" onchange="toggleSpecialInput()"> 特別約定事項如下：</label>
            </div>
            <div id="specialInputArea" class="indent hidden">
                <textarea id="special_terms_text" rows="5" placeholder="請輸入內容..."></textarea>
            </div>
        </div>

        <hr>

        <div class="btn-group">
            <button class="secondary" onclick="prevPage(1)">&lt; 上一步</button>
            <button class="success" onclick="generateContract()">生成 Word</button>
        </div>
    </div>
</div>

<script>
    // ★ 內建銀行與分行資料
    const bankData = [
      {
        "code": "004",
        "name": "臺灣銀行",
        "branches": [
          {"code": "0037", "name": "營業部"}, {"code": "0059", "name": "公庫部"}, {"code": "0071", "name": "館前分行"}, {"code": "0093", "name": "臺南分行"}, {"code": "0107", "name": "臺中分行"}, {"code": "0118", "name": "高雄分行"}, {"code": "0129", "name": "基隆分行"}, {"code": "0130", "name": "中興新村分行"}, {"code": "0141", "name": "嘉義分行"}, {"code": "0152", "name": "新竹分行"}, {"code": "0163", "name": "彰化分行"}, {"code": "0174", "name": "屏東分行"}, {"code": "0185", "name": "花蓮分行"}, {"code": "0196", "name": "延平分行"}, {"code": "0200", "name": "中山分行"}, {"code": "0211", "name": "高雄加工出口區分行"}, {"code": "0222", "name": "宜蘭分行"}, {"code": "0233", "name": "臺東分行"}, {"code": "0244", "name": "澎湖分行"}, {"code": "0255", "name": "鳳山分行"}, {"code": "0266", "name": "桃園分行"}, {"code": "0277", "name": "板橋分行"}, {"code": "0288", "name": "新營分行"}, {"code": "0299", "name": "苗栗分行"}, {"code": "0303", "name": "豐原分行"}, {"code": "0314", "name": "斗六分行"}, {"code": "0325", "name": "南投分行"}, {"code": "0336", "name": "南門分行"}, {"code": "0347", "name": "公館分行"}, {"code": "0358", "name": "左營分行"}, {"code": "0369", "name": "北投分行"}, {"code": "0370", "name": "霧峰分行"}, {"code": "0381", "name": "金門分行"}, {"code": "0392", "name": "馬祖分行"}, {"code": "0406", "name": "安平分行"}, {"code": "0417", "name": "中壢分行"}, {"code": "0428", "name": "三重分行"}, {"code": "0439", "name": "頭份分行"}, {"code": "0440", "name": "前鎮分行"}, {"code": "0451", "name": "城中分行"}, {"code": "0462", "name": "民權分行"}, {"code": "0473", "name": "潭子分行"}, {"code": "0484", "name": "連城分行"}, {"code": "0495", "name": "員林分行"}, {"code": "0509", "name": "松江分行"}, {"code": "0510", "name": "鼓山分行"}, {"code": "0521", "name": "龍山分行"}, {"code": "0532", "name": "忠孝分行"}, {"code": "0543", "name": "信義分行"}, {"code": "0554", "name": "復興分行"}, {"code": "0565", "name": "三民分行"}, {"code": "0576", "name": "臺中港分行"}, {"code": "0587", "name": "羅東分行"}, {"code": "0598", "name": "埔里分行"}, {"code": "0602", "name": "岡山分行"}, {"code": "0613", "name": "新興分行"}, {"code": "0624", "name": "苓雅分行"}, {"code": "0646", "name": "松山分行"}, {"code": "0657", "name": "健行分行"}, {"code": "0668", "name": "中和分行"}, {"code": "0679", "name": "太保分行"}, {"code": "0680", "name": "竹北分行"}, {"code": "0705", "name": "士林分行"}, {"code": "0716", "name": "新莊分行"}, {"code": "0727", "name": "大甲分行"}, {"code": "0738", "name": "新竹科學園區分行"}, {"code": "0749", "name": "樹林分行"}, {"code": "0750", "name": "新店分行"}, {"code": "0794", "name": "黎明分行"}, {"code": "0808", "name": "民生分行"}, {"code": "0819", "name": "永康分行"}, {"code": "0820", "name": "三多分行"}, {"code": "0853", "name": "臺北世貿中心分行"}, {"code": "0864", "name": "大安分行"}, {"code": "0875", "name": "華江分行"}, {"code": "0886", "name": "潮州分行"}, {"code": "0897", "name": "蘇澳分行"}, {"code": "0901", "name": "大雅分行"}, {"code": "0912", "name": "楠梓分行"}, {"code": "0923", "name": "臺中工業區分行"}, {"code": "1067", "name": "敦化分行"}, {"code": "1078", "name": "南港分行"}, {"code": "1089", "name": "和平分行"}, {"code": "1090", "name": "水湳分行"}, {"code": "1104", "name": "中崙分行"}, {"code": "1115", "name": "土城分行"}, {"code": "1159", "name": "桃園國際機場分行"}, {"code": "1160", "name": "大昌分行"}, {"code": "1182", "name": "五甲分行"}, {"code": "1193", "name": "博愛分行"}, {"code": "1207", "name": "中庄分行"}, {"code": "1218", "name": "平鎮分行"}, {"code": "1229", "name": "仁愛分行"}, {"code": "1230", "name": "南崁分行"}, {"code": "1241", "name": "圓山分行"}, {"code": "1355", "name": "五股分行"}, {"code": "1366", "name": "大里分行"}, {"code": "1377", "name": "安南分行"}, {"code": "1414", "name": "西屯分行"}, {"code": "1425", "name": "天母分行"}, {"code": "1436", "name": "鹿港分行"}, {"code": "1447", "name": "內壢分行"}, {"code": "1469", "name": "臺南科學園區分行"}, {"code": "1470", "name": "虎尾分行"}, {"code": "1481", "name": "淡水分行"}, {"code": "1539", "name": "內湖分行"}, {"code": "1540", "name": "嘉北分行"}, {"code": "1551", "name": "東港分行"}, {"code": "1562", "name": "汐止分行"}, {"code": "1573", "name": "梧棲分行"}, {"code": "1595", "name": "小港分行"}, {"code": "1609", "name": "中屏分行"}, {"code": "1621", "name": "群賢分行"}, {"code": "1643", "name": "北大路分行"}, {"code": "1654", "name": "文山分行"}, {"code": "1702", "name": "太平分行"}, {"code": "1713", "name": "德芳分行"}, {"code": "1724", "name": "建國分行"}, {"code": "1768", "name": "屏東農科園區分行"}, {"code": "1861", "name": "東桃園分行"}, {"code": "1872", "name": "蘆洲分行"}, {"code": "1919", "name": "高雄國際機場分行"}, {"code": "1931", "name": "永吉簡易型分行"}, {"code": "1942", "name": "東門簡易型分行"}, {"code": "1953", "name": "愛國簡易型分行"}, {"code": "1986", "name": "臺電簡易型分行"}, {"code": "2053", "name": "北府簡易型分行"}, {"code": "2189", "name": "臺北港分行"}, {"code": "2204", "name": "臺中科學園區分行"}, {"code": "2215", "name": "高雄科學園區分行"}, {"code": "2237", "name": "東湖分行"}, {"code": "2248", "name": "高榮分行"}, {"code": "2259", "name": "南港軟體園區分行"}, {"code": "2260", "name": "龍潭分行"}, {"code": "2271", "name": "仁德分行"}, {"code": "2282", "name": "林口分行"}, {"code": "2293", "name": "木柵分行"}, {"code": "2307", "name": "臺南創新園區分行"}, {"code": "2363", "name": "武昌分行"}, {"code": "2385", "name": "臺北分行"}, {"code": "2396", "name": "金山分行"}, {"code": "2400", "name": "信安分行"}, {"code": "2411", "name": "劍潭分行"}, {"code": "2422", "name": "萬華分行"}, {"code": "2433", "name": "板新分行"}, {"code": "2444", "name": "新永和分行"}, {"code": "2455", "name": "南新莊分行"}, {"code": "2477", "name": "新明分行"}, {"code": "2488", "name": "六家分行"}, {"code": "2499", "name": "北臺中分行"}, {"code": "2525", "name": "嘉南分行"}, {"code": "2536", "name": "南都分行"}, {"code": "2558", "name": "北高雄分行"}, {"code": "2569", "name": "成功分行"}, {"code": "2570", "name": "北花蓮分行"}, {"code": "2709", "name": "新湖分行"}, {"code": "2710", "name": "五福分行"}, {"code": "2721", "name": "六甲頂分行"}, {"code": "2787", "name": "中都分行"}, {"code": "2798", "name": "臺北國際機場分行"}, {"code": "2802", "name": "新莊副都心分行"}, {"code": "2835", "name": "仁武分行"}, {"code": "2891", "name": "臺中國際機場分行"}, {"code": "2905", "name": "臺中精密園區分行"}, {"code": "2972", "name": "亞矽創新分行"}
        ]
      },
      {
        "code": "005",
        "name": "臺灣土地銀行",
        "branches": [
          {"code": "0027", "name": "基隆分行"}, {"code": "0038", "name": "中和分行"}, {"code": "0049", "name": "南港分行"}, {"code": "0050", "name": "台北分行"}, {"code": "0061", "name": "民權分行"}, {"code": "0072", "name": "古亭分行"}, {"code": "0083", "name": "長安分行"}, {"code": "0094", "name": "士林分行"}, {"code": "0108", "name": "三重分行"}, {"code": "0119", "name": "宜蘭分行"}, {"code": "0120", "name": "羅東分行"}, {"code": "0131", "name": "桃園分行"}, {"code": "0142", "name": "中壢分行"}, {"code": "0153", "name": "石門分行"}, {"code": "0164", "name": "新竹分行"}, {"code": "0175", "name": "竹東分行"}, {"code": "0186", "name": "花蓮分行"}, {"code": "0197", "name": "玉里分行"}, {"code": "0201", "name": "苗栗分行"}, {"code": "0212", "name": "頭份分行"}, {"code": "0223", "name": "豐原分行"}, {"code": "0234", "name": "大甲分行"}, {"code": "0245", "name": "台中分行"}, {"code": "0256", "name": "南投分行"}, {"code": "0267", "name": "員林分行"}, {"code": "0278", "name": "斗六分行"}, {"code": "0289", "name": "北港分行"}, {"code": "0290", "name": "嘉義分行"}, {"code": "0304", "name": "新營分行"}, {"code": "0315", "name": "永康分行"}, {"code": "0326", "name": "台南分行"}, {"code": "0337", "name": "高雄分行"}, {"code": "0348", "name": "岡山分行"}, {"code": "0359", "name": "美濃分行"}, {"code": "0360", "name": "屏東分行"}, {"code": "0371", "name": "台東分行"}, {"code": "0382", "name": "青年分行"}, {"code": "0393", "name": "金門分行"}, {"code": "0407", "name": "澎湖分行"}, {"code": "0418", "name": "營業部"}, {"code": "0452", "name": "和平分行"}, {"code": "0463", "name": "潮州分行"}, {"code": "0474", "name": "彰化分行"}, {"code": "0485", "name": "中山分行"}, {"code": "0496", "name": "永和分行"}, {"code": "0500", "name": "板橋分行"}, {"code": "0511", "name": "鳳山分行"}, {"code": "0522", "name": "湖口分行"}, {"code": "0533", "name": "蘇澳分行"}, {"code": "0544", "name": "新興分行"}, {"code": "0555", "name": "西台中分行"}, {"code": "0566", "name": "虎尾分行"}, {"code": "0577", "name": "仁愛分行"}, {"code": "0588", "name": "忠孝分行"}, {"code": "0599", "name": "中正分行"}, {"code": "0614", "name": "新店分行"}, {"code": "0625", "name": "北台南分行"}, {"code": "0636", "name": "松山分行"}, {"code": "0647", "name": "內湖分行"}, {"code": "0658", "name": "三民分行"}, {"code": "0669", "name": "民雄分行"}, {"code": "0670", "name": "大社分行"}, {"code": "0692", "name": "前鎮分行"}, {"code": "0706", "name": "路竹分行"}, {"code": "0717", "name": "五甲分行"}, {"code": "0728", "name": "太平分行"}, {"code": "0740", "name": "敦化分行"}, {"code": "0762", "name": "蘆洲分行"}, {"code": "0773", "name": "北台中分行"}, {"code": "0784", "name": "苓雅分行"}, {"code": "0795", "name": "信義分行"}, {"code": "0809", "name": "土城分行"}, {"code": "0810", "name": "淡水分行"}, {"code": "0821", "name": "草屯分行"}, {"code": "0832", "name": "東台南分行"}, {"code": "0843", "name": "通霄分行"}, {"code": "0854", "name": "學甲分行"}, {"code": "0865", "name": "新莊分行"}, {"code": "0876", "name": "雙和分行"}, {"code": "0898", "name": "白河分行"}, {"code": "0902", "name": "復興分行"}, {"code": "0913", "name": "平鎮分行"}, {"code": "0935", "name": "文山分行"}, {"code": "0946", "name": "中港分行"}, {"code": "0957", "name": "東板橋分行"}, {"code": "0968", "name": "南崁分行"}, {"code": "0979", "name": "建國分行"}, {"code": "0980", "name": "樹林分行"}, {"code": "0991", "name": "東台北分行"}, {"code": "1002", "name": "西三重分行"}, {"code": "1013", "name": "南台中分行"}, {"code": "1024", "name": "長春分行"}, {"code": "1035", "name": "東新竹分行"}, {"code": "1046", "name": "新市分行"}, {"code": "1057", "name": "博愛分行"}, {"code": "1068", "name": "中崙分行"}, {"code": "1079", "name": "華江分行"}, {"code": "1080", "name": "竹北分行"}, {"code": "1091", "name": "安平分行"}, {"code": "1105", "name": "嘉興分行"}, {"code": "1116", "name": "南新莊分行"}, {"code": "1127", "name": "三峽分行"}, {"code": "1138", "name": "沙鹿分行"}, {"code": "1149", "name": "南桃園分行"}, {"code": "1150", "name": "汐止分行"}, {"code": "1161", "name": "萬華分行"}, {"code": "1172", "name": "小港分行"}, {"code": "1183", "name": "新工分行"}, {"code": "1194", "name": "烏日分行"}, {"code": "1208", "name": "西湖分行"}, {"code": "1219", "name": "八德分行"}, {"code": "1220", "name": "北屯分行"}, {"code": "1231", "name": "大安分行"}, {"code": "1242", "name": "北中壢分行"}, {"code": "1253", "name": "高樹分行"}, {"code": "1264", "name": "枋寮分行"}, {"code": "1286", "name": "金城分行"}, {"code": "1297", "name": "光復分行"}, {"code": "1301", "name": "左營分行"}, {"code": "1312", "name": "北桃園分行"}, {"code": "1323", "name": "東港分行"}, {"code": "1334", "name": "天母分行"}, {"code": "1345", "name": "泰山分行"}, {"code": "1356", "name": "中科分行"}, {"code": "1367", "name": "大園分行"}, {"code": "1378", "name": "楊梅分行"}, {"code": "1404", "name": "城東分行"}, {"code": "1415", "name": "松南分行"}, {"code": "1426", "name": "福興分行"}, {"code": "1437", "name": "林口分行"}, {"code": "1448", "name": "西屯分行"}, {"code": "1459", "name": "內壢分行"}, {"code": "1460", "name": "竹南分行"}, {"code": "1471", "name": "安南分行"}, {"code": "1482", "name": "汐科分行"}, {"code": "1493", "name": "楠梓分行"}, {"code": "1507", "name": "大里分行"}, {"code": "1518", "name": "大灣分行"}, {"code": "1530", "name": "大發分行"}, {"code": "1563", "name": "工研院分行"}, {"code": "1574", "name": "北三重分行"}, {"code": "1585", "name": "圓通分行"}, {"code": "1600", "name": "大直分行"}, {"code": "1611", "name": "南屯分行"}, {"code": "1633", "name": "寶中分行"}, {"code": "1644", "name": "中清分行"}, {"code": "1655", "name": "南京東路分行"}, {"code": "1666", "name": "仁武分行"}, {"code": "1677", "name": "青埔分行"}
        ]
      },
      {
        "code": "006",
        "name": "合作金庫商業銀行",
        "branches": [
          {"code": "0017", "name": "總行"}, {"code": "0028", "name": "館前分行"}, {"code": "0039", "name": "西門分行"}, {"code": "0040", "name": "延平分行"}, {"code": "0051", "name": "大稻埕分行"}, {"code": "0062", "name": "東門分行"}, {"code": "0073", "name": "松山分行"}, {"code": "0084", "name": "新店分行"}, {"code": "0095", "name": "永和分行"}, {"code": "0109", "name": "三重分行"}, {"code": "0110", "name": "板橋分行"}, {"code": "0121", "name": "基隆分行"}, {"code": "0132", "name": "宜蘭分行"}, {"code": "0143", "name": "蘇澳分行"}, {"code": "0154", "name": "桃園分行"}, {"code": "0165", "name": "中壢分行"}, {"code": "0176", "name": "新竹分行"}, {"code": "0187", "name": "苗栗分行"}, {"code": "0198", "name": "頭份分行"}, {"code": "0202", "name": "豐原分行"}, {"code": "0213", "name": "沙鹿分行"}, {"code": "0224", "name": "台中分行"}, {"code": "0235", "name": "彰化分行"}, {"code": "0246", "name": "員林分行"}, {"code": "0257", "name": "南投分行"}, {"code": "0268", "name": "斗六分行"}, {"code": "0279", "name": "北港分行"}, {"code": "0280", "name": "嘉義分行"}, {"code": "0291", "name": "新營分行"}, {"code": "0305", "name": "台南分行"}, {"code": "0316", "name": "成功分行"}, {"code": "0327", "name": "鳳山分行"}, {"code": "0338", "name": "岡山分行"}, {"code": "0349", "name": "高雄分行"}, {"code": "0350", "name": "新興分行"}, {"code": "0361", "name": "屏東分行"}, {"code": "0372", "name": "潮州分行"}, {"code": "0383", "name": "花蓮分行"}, {"code": "0394", "name": "台東分行"}, {"code": "0408", "name": "澎湖分行"}, {"code": "0419", "name": "南京東路分行"}, {"code": "0431", "name": "大同分行"}, {"code": "0453", "name": "忠孝分行"}, {"code": "0464", "name": "景美分行"}, {"code": "0475", "name": "士林分行"}, {"code": "0486", "name": "汐止分行"}, {"code": "0497", "name": "新莊分行"}, {"code": "0501", "name": "中興分行"}, {"code": "0512", "name": "苓雅分行"}, {"code": "0545", "name": "台北分行"}, {"code": "0567", "name": "營業部"}, {"code": "0578", "name": "南豐原分行"}, {"code": "0589", "name": "羅東分行"}, {"code": "0590", "name": "三民分行"}, {"code": "0604", "name": "城東分行"}, {"code": "0615", "name": "佳里分行"}, {"code": "0626", "name": "中和分行"}, {"code": "0637", "name": "南高雄分行"}, {"code": "0648", "name": "南嘉義分行"}, {"code": "0659", "name": "竹東分行"}, {"code": "0660", "name": "林口文化分行"}, {"code": "0671", "name": "東三重分行"}, {"code": "0682", "name": "南興分行"}, {"code": "0693", "name": "五權分行"}, {"code": "0707", "name": "埔里分行"}, {"code": "0729", "name": "南勢角分行"}, {"code": "0730", "name": "朴子分行"}, {"code": "0763", "name": "大安分行"}, {"code": "0774", "name": "民權分行"}, {"code": "0785", "name": "東高雄分行"}, {"code": "0796", "name": "東台北分行"}, {"code": "0800", "name": "城內分行"}, {"code": "0811", "name": "建國分行"}, {"code": "0822", "name": "圓山分行"}, {"code": "0833", "name": "信義分行"}, {"code": "0844", "name": "長春分行"}, {"code": "0855", "name": "仁愛分行"}, {"code": "0866", "name": "玉成分行"}, {"code": "0877", "name": "古亭分行"}, {"code": "0888", "name": "長安分行"}, {"code": "0899", "name": "松興分行"}, {"code": "0903", "name": "民族分行"}, {"code": "0914", "name": "復興分行"}, {"code": "0936", "name": "民生分行"}, {"code": "0947", "name": "新生分行"}, {"code": "0981", "name": "東新莊分行"}, {"code": "0992", "name": "蘆洲分行"}, {"code": "1003", "name": "前金分行"}, {"code": "1014", "name": "成大分行"}, {"code": "1025", "name": "大里分行"}, {"code": "1036", "name": "海山分行"}, {"code": "1070", "name": "南台中分行"}, {"code": "1081", "name": "埔墘分行"}, {"code": "1092", "name": "慈文分行"}, {"code": "1117", "name": "迴龍分行"}, {"code": "1128", "name": "太平分行"}, {"code": "1139", "name": "彰營分行"}, {"code": "1140", "name": "彰儲分行"}, {"code": "1151", "name": "虎尾分行"}, {"code": "1162", "name": "南屯分行"}, {"code": "1173", "name": "西台中分行"}, {"code": "1184", "name": "溪湖分行"}, {"code": "1195", "name": "烏日分行"}, {"code": "1209", "name": "和美分行"}, {"code": "1210", "name": "南桃園分行"}, {"code": "1221", "name": "屏南分行"}, {"code": "1232", "name": "東台南分行"}, {"code": "1243", "name": "北新竹分行"}, {"code": "1254", "name": "復旦分行"}, {"code": "1265", "name": "竹山分行"}, {"code": "1276", "name": "前鎮分行"}, {"code": "1287", "name": "灣內分行"}, {"code": "1298", "name": "路竹分行"}, {"code": "1302", "name": "憲德分行"}, {"code": "1313", "name": "竹北分行"}, {"code": "1324", "name": "北新分行"}, {"code": "1335", "name": "五洲分行"}, {"code": "1346", "name": "臺大分行"}, {"code": "1368", "name": "龜山分行"}, {"code": "1379", "name": "大溪分行"}, {"code": "1380", "name": "龍潭分行"}, {"code": "1391", "name": "中原分行"}, {"code": "1405", "name": "三興分行"}, {"code": "1427", "name": "石牌分行"}, {"code": "1438", "name": "西屯分行"}, {"code": "1449", "name": "雙和分行"}, {"code": "1450", "name": "土城分行"}, {"code": "1461", "name": "光華分行"}, {"code": "1472", "name": "北台南分行"}, {"code": "1494", "name": "北屯分行"}, {"code": "1508", "name": "一心路分行"}, {"code": "1519", "name": "三峽分行"}, {"code": "1520", "name": "北嘉義分行"}, {"code": "1531", "name": "永康分行"}, {"code": "1542", "name": "平鎮分行"}, {"code": "1553", "name": "大發分行"}, {"code": "1564", "name": "內湖分行"}, {"code": "1575", "name": "光復分行"}, {"code": "1586", "name": "二重分行"}, {"code": "1601", "name": "北台中分行"}, {"code": "1656", "name": "軍功分行"}, {"code": "1715", "name": "永安分行"}, {"code": "1726", "name": "中權分行"}, {"code": "1759", "name": "太原分行"}, {"code": "1760", "name": "松竹分行"}, {"code": "1852", "name": "中清分行"}, {"code": "1885", "name": "建成分行"}, {"code": "1900", "name": "朝馬分行"}, {"code": "1988", "name": "美村分行"}, {"code": "2000", "name": "黎明分行"}, {"code": "2044", "name": "精武分行"}, {"code": "2055", "name": "文心分行"}, {"code": "2077", "name": "神岡分行"}, {"code": "3030", "name": "大竹分行"}, {"code": "3074", "name": "林內分行"}, {"code": "3100", "name": "南港分行"}, {"code": "3111", "name": "伸港分行"}, {"code": "3122", "name": "五股分行"}, {"code": "3133", "name": "樹林分行"}, {"code": "3155", "name": "林口分行"}, {"code": "3199", "name": "大坪林分行"}, {"code": "3373", "name": "鶯歌分行"}, {"code": "3395", "name": "鹿港分行"}, {"code": "3409", "name": "新樹分行"}, {"code": "3410", "name": "六家分行"}, {"code": "3421", "name": "大雅分行"}, {"code": "3443", "name": "八德分行"}, {"code": "3465", "name": "鼓山分行"}, {"code": "3476", "name": "大社分行"}, {"code": "3513", "name": "林園分行"}, {"code": "3524", "name": "高雄科技園區分行"}, {"code": "3535", "name": "蘆竹分行"}, {"code": "3546", "name": "北中和分行"}, {"code": "3557", "name": "新湖分行"}, {"code": "3568", "name": "丹鳳分行"}, {"code": "3580", "name": "旗山分行"}, {"code": "3591", "name": "大園分行"}, {"code": "3616", "name": "潭子分行"}, {"code": "3627", "name": "后里分行"}, {"code": "3638", "name": "長庚分行"}, {"code": "3649", "name": "楠梓分行"}, {"code": "3650", "name": "青埔分行"}, {"code": "3661", "name": "民雄分行"}, {"code": "5012", "name": "自強分行"}, {"code": "5023", "name": "中山分行"}, {"code": "5034", "name": "敦南分行"}, {"code": "5056", "name": "世貿分行"}, {"code": "5089", "name": "北士林分行"}, {"code": "5090", "name": "信維分行"}, {"code": "5115", "name": "大湖分行"}, {"code": "5137", "name": "國醫中心分行"}, {"code": "5159", "name": "南門分行"}, {"code": "5160", "name": "新中分行"}, {"code": "5171", "name": "中港分行"}, {"code": "5182", "name": "衛道分行"}, {"code": "5193", "name": "忠明南路分行"}, {"code": "5207", "name": "東基隆分行"}, {"code": "5218", "name": "赤崁分行"}, {"code": "5229", "name": "府城分行"}, {"code": "5230", "name": "開元分行"}, {"code": "5241", "name": "港都分行"}, {"code": "5252", "name": "七賢分行"}, {"code": "5274", "name": "十全分行"}, {"code": "5285", "name": "九如分行"}, {"code": "5296", "name": "小港分行"}, {"code": "5300", "name": "北三峽分行"}, {"code": "5311", "name": "板新分行"}, {"code": "5355", "name": "寶橋分行"}, {"code": "5366", "name": "新泰分行"}, {"code": "5377", "name": "北土城分行"}, {"code": "5388", "name": "南汐止分行"}, {"code": "5403", "name": "五股工業區分行"}, {"code": "5414", "name": "北羅東分行"}, {"code": "5425", "name": "礁溪分行"}, {"code": "5436", "name": "東桃園分行"}, {"code": "5447", "name": "壢新分行"}, {"code": "5458", "name": "南崁分行"}, {"code": "5470", "name": "新明分行"}, {"code": "5481", "name": "楊梅分行"}, {"code": "5517", "name": "東竹北分行"}, {"code": "5528", "name": "北苗栗分行"}, {"code": "5539", "name": "竹南分行"}, {"code": "5540", "name": "豐中分行"}, {"code": "5551", "name": "北大里分行"}, {"code": "5562", "name": "東沙鹿分行"}, {"code": "5573", "name": "草屯分行"}, {"code": "5584", "name": "集集分行"}, {"code": "5609", "name": "員新分行"}, {"code": "5610", "name": "南彰化分行"}, {"code": "5621", "name": "北斗分行"}, {"code": "5632", "name": "竹塹分行"}, {"code": "5643", "name": "新竹科學園區分行"}, {"code": "5665", "name": "雲林分行"}, {"code": "5698", "name": "北新營分行"}, {"code": "5702", "name": "仁德分行"}, {"code": "5713", "name": "南永康分行"}, {"code": "5735", "name": "鳳松分行"}, {"code": "5757", "name": "美濃分行"}, {"code": "5768", "name": "大樹分行"}, {"code": "5816", "name": "東港分行"}, {"code": "5827", "name": "萬丹分行"}, {"code": "5838", "name": "枋寮分行"}, {"code": "5849", "name": "東嘉義分行"}, {"code": "5850", "name": "北花蓮分行"}, {"code": "5919", "name": "大直分行"}, {"code": "5942", "name": "水湳分行"}, {"code": "6064", "name": "仁美分行"}, {"code": "6097", "name": "社皮分行"}, {"code": "9021", "name": "五甲分行"}, {"code": "9043", "name": "淡水分行"}
        ]
      },
      {
        "code": "007",
        "name": "第一商業銀行",
        "branches": [
          {"code": "0937", "name": "營業部"}, {"code": "0948", "name": "安和分行"}, {"code": "1015", "name": "南港分行"}, {"code": "1026", "name": "西門分行"}, {"code": "1037", "name": "忠孝路分行"}, {"code": "1060", "name": "景美分行"}, {"code": "1071", "name": "大直分行"}, {"code": "1118", "name": "大稻埕分行"}, {"code": "1130", "name": "信維分行"}, {"code": "1211", "name": "建成分行"}, {"code": "1299", "name": "華山分行"}, {"code": "1314", "name": "大同分行"}, {"code": "1336", "name": "新生分行"}, {"code": "1358", "name": "劍潭分行"}, {"code": "1406", "name": "圓山分行"}, {"code": "1417", "name": "中山分行"}, {"code": "1428", "name": "中崙分行"}, {"code": "1439", "name": "南京東路分行"}, {"code": "1440", "name": "城東分行"}, {"code": "1451", "name": "民生分行"}, {"code": "1462", "name": "松江分行"}, {"code": "1473", "name": "民權分行"}, {"code": "1484", "name": "八德分行"}, {"code": "1495", "name": "長春分行"}, {"code": "1509", "name": "內湖分行"}, {"code": "1510", "name": "松山分行"}, {"code": "1521", "name": "延吉分行"}, {"code": "1532", "name": "光復分行"}, {"code": "1554", "name": "興雅分行"}, {"code": "1576", "name": "永春分行"}, {"code": "1587", "name": "內科園區分行"}, {"code": "1598", "name": "吉林分行"}, {"code": "1602", "name": "仁愛分行"}, {"code": "1613", "name": "大安分行"}, {"code": "1624", "name": "信義分行"}, {"code": "1635", "name": "復興分行"}, {"code": "1646", "name": "敦化分行"}, {"code": "1657", "name": "仁和分行"}, {"code": "1668", "name": "世貿分行"}, {"code": "1679", "name": "木柵分行"}, {"code": "1691", "name": "新湖分行"}, {"code": "1716", "name": "古亭分行"}, {"code": "1727", "name": "南門分行"}, {"code": "1738", "name": "公館分行"}, {"code": "1761", "name": "和平分行"}, {"code": "1819", "name": "萬華分行"}, {"code": "1831", "name": "雙園分行"}, {"code": "1901", "name": "天母分行"}, {"code": "1912", "name": "北投分行"}, {"code": "1923", "name": "士林分行"}, {"code": "1934", "name": "建國分行"}, {"code": "1956", "name": "石牌分行"}, {"code": "2012", "name": "板橋分行"}, {"code": "2023", "name": "華江分行"}, {"code": "2034", "name": "樹林分行"}, {"code": "2056", "name": "土城分行"}, {"code": "2089", "name": "林口工二分行"}, {"code": "2115", "name": "三重埔分行"}, {"code": "2126", "name": "長泰分行"}, {"code": "2137", "name": "蘆洲分行"}, {"code": "2148", "name": "頭前分行"}, {"code": "2159", "name": "五股分行"}, {"code": "2160", "name": "重陽分行"}, {"code": "2171", "name": "五股工業區分行"}, {"code": "2182", "name": "淡水分行"}, {"code": "2193", "name": "新蘆分行"}, {"code": "2218", "name": "新店分行"}, {"code": "2229", "name": "大坪林分行"}, {"code": "2300", "name": "泰山分行"}, {"code": "2311", "name": "新莊分行"}, {"code": "2322", "name": "鶯歌分行"}, {"code": "2333", "name": "中和分行"}, {"code": "2344", "name": "永和分行"}, {"code": "2355", "name": "雙和分行"}, {"code": "2366", "name": "連城分行"}, {"code": "2377", "name": "瑞芳分行"}, {"code": "2388", "name": "埔墘分行"}, {"code": "2399", "name": "丹鳳分行"}, {"code": "2414", "name": "基隆分行"}, {"code": "2436", "name": "哨船頭分行"}, {"code": "2458", "name": "汐止分行"}, {"code": "2469", "name": "汐科分行"}, {"code": "2470", "name": "幸福分行"}, {"code": "2517", "name": "宜蘭分行"}, {"code": "2610", "name": "羅東分行"}, {"code": "2621", "name": "蘇澳分行"}, {"code": "2713", "name": "桃園分行"}, {"code": "2724", "name": "北桃分行"}, {"code": "2791", "name": "大湳分行"}, {"code": "2805", "name": "內壢分行"}, {"code": "2816", "name": "中壢分行"}, {"code": "2827", "name": "西壢分行"}, {"code": "2838", "name": "平鎮分行"}, {"code": "2849", "name": "大園分行"}, {"code": "2850", "name": "南崁分行"}, {"code": "2861", "name": "青埔分行"}, {"code": "2883", "name": "楊梅分行"}, {"code": "2908", "name": "林口分行"}, {"code": "2919", "name": "大溪分行"}, {"code": "2920", "name": "龍潭分行"}, {"code": "3019", "name": "新竹分行"}, {"code": "3020", "name": "東門分行"}, {"code": "3031", "name": "竹科分行"}, {"code": "3112", "name": "竹東分行"}, {"code": "3123", "name": "關西分行"}, {"code": "3134", "name": "竹北分行"}, {"code": "3215", "name": "苗栗分行"}, {"code": "3318", "name": "竹南分行"}, {"code": "3329", "name": "頭份分行"}, {"code": "4016", "name": "台中分行"}, {"code": "4027", "name": "南台中分行"}, {"code": "4038", "name": "北台中分行"}, {"code": "4049", "name": "中港分行"}, {"code": "4050", "name": "北屯分行"}, {"code": "4061", "name": "進化分行"}, {"code": "4072", "name": "南屯分行"}, {"code": "4119", "name": "豐原分行"}, {"code": "4120", "name": "大里分行"}, {"code": "4153", "name": "中科分行"}, {"code": "4212", "name": "東勢分行"}, {"code": "4223", "name": "沙鹿分行"}, {"code": "4234", "name": "大甲分行"}, {"code": "4245", "name": "太平分行"}, {"code": "4256", "name": "清水分行"}, {"code": "4267", "name": "大雅分行"}, {"code": "4315", "name": "南投分行"}, {"code": "4418", "name": "草屯分行"}, {"code": "4429", "name": "埔里分行"}, {"code": "4511", "name": "彰化分行"}, {"code": "4614", "name": "員林分行"}, {"code": "4625", "name": "鹿港分行"}, {"code": "4636", "name": "溪湖分行"}, {"code": "4647", "name": "北斗分行"}, {"code": "4717", "name": "和美分行"}, {"code": "5013", "name": "嘉義分行"}, {"code": "5035", "name": "興嘉分行"}, {"code": "5116", "name": "朴子分行"}, {"code": "5219", "name": "斗六分行"}, {"code": "5312", "name": "北港分行"}, {"code": "5323", "name": "西螺分行"}, {"code": "5334", "name": "虎尾分行"}, {"code": "6010", "name": "台南分行"}, {"code": "6043", "name": "富強分行"}, {"code": "6054", "name": "赤崁分行"}, {"code": "6065", "name": "竹溪分行"}, {"code": "6076", "name": "金城分行"}, {"code": "6087", "name": "安南分行"}, {"code": "6113", "name": "新營分行"}, {"code": "6216", "name": "鹽水分行"}, {"code": "6227", "name": "麻豆分行"}, {"code": "6238", "name": "善化分行"}, {"code": "6249", "name": "佳里分行"}, {"code": "6250", "name": "新化分行"}, {"code": "6261", "name": "大灣分行"}, {"code": "6294", "name": "歸仁分行"}, {"code": "6308", "name": "永康分行"}, {"code": "7017", "name": "高雄分行"}, {"code": "7028", "name": "鹽埕分行"}, {"code": "7039", "name": "新興分行"}, {"code": "7040", "name": "三民分行"}, {"code": "7051", "name": "苓雅分行"}, {"code": "7062", "name": "左營分行"}, {"code": "7073", "name": "楠梓分行"}, {"code": "7084", "name": "五福分行"}, {"code": "7095", "name": "十全分行"}, {"code": "7109", "name": "前鎮分行"}, {"code": "7110", "name": "灣內分行"}, {"code": "7121", "name": "博愛分行"}, {"code": "7143", "name": "小港分行"}, {"code": "7202", "name": "五甲分行"}, {"code": "7213", "name": "鳳山分行"}, {"code": "7305", "name": "路竹分行"}, {"code": "7316", "name": "岡山分行"}, {"code": "7327", "name": "旗山分行"}, {"code": "7338", "name": "林園分行"}, {"code": "7419", "name": "屏東分行"}, {"code": "7512", "name": "潮州分行"}, {"code": "7523", "name": "東港分行"}, {"code": "7534", "name": "恆春分行"}, {"code": "7785", "name": "梓本分行"}, {"code": "8014", "name": "花蓮分行"}, {"code": "8117", "name": "台東分行"}, {"code": "8210", "name": "澎湖分行"}
        ]
      },
      {
        "code": "008",
        "name": "華南商業銀行",
        "branches": [
          {"code": "1005", "name": "營業部"}, {"code": "1016", "name": "儲蓄分行"}, {"code": "1027", "name": "總行國際金融部"}, {"code": "1038", "name": "城內分行"}, {"code": "1049", "name": "大稻埕分行"}, {"code": "1050", "name": "建成分行"}, {"code": "1061", "name": "中山分行"}, {"code": "1072", "name": "圓山分行"}, {"code": "1083", "name": "城東分行"}, {"code": "1094", "name": "西門分行"}, {"code": "1108", "name": "南松山分行"}, {"code": "1119", "name": "仁愛路分行"}, {"code": "1120", "name": "南京東路分行"}, {"code": "1131", "name": "新生分行"}, {"code": "1142", "name": "大同分行"}, {"code": "1153", "name": "松山分行"}, {"code": "1164", "name": "中崙分行"}, {"code": "1175", "name": "臺北南門分行"}, {"code": "1186", "name": "公館分行"}, {"code": "1197", "name": "信義分行"}, {"code": "1201", "name": "忠孝東路分行"}, {"code": "1212", "name": "和平分行"}, {"code": "1223", "name": "雙園分行"}, {"code": "1234", "name": "士林分行"}, {"code": "1245", "name": "東台北分行"}, {"code": "1256", "name": "大安分行"}, {"code": "1267", "name": "民生分行"}, {"code": "1278", "name": "復興分行"}, {"code": "1289", "name": "龍江分行"}, {"code": "1290", "name": "永吉分行"}, {"code": "1304", "name": "敦化分行"}, {"code": "1326", "name": "大直分行"}, {"code": "1337", "name": "敦和分行"}, {"code": "1348", "name": "東湖分行"}, {"code": "1360", "name": "東興分行"}, {"code": "1371", "name": "北南港分行"}, {"code": "1430", "name": "南內湖分行"}, {"code": "1452", "name": "長安分行"}, {"code": "1474", "name": "懷生分行"}, {"code": "1485", "name": "中華路分行"}, {"code": "1496", "name": "信維分行"}, {"code": "1511", "name": "埔墘分行"}, {"code": "1522", "name": "石牌分行"}, {"code": "1533", "name": "瑞祥分行"}, {"code": "1544", "name": "台大分行"}, {"code": "1566", "name": "世貿分行"}, {"code": "1577", "name": "萬華分行"}, {"code": "1588", "name": "南港分行"}, {"code": "1599", "name": "華江分行"}, {"code": "1603", "name": "板橋分行"}, {"code": "1614", "name": "三重分行"}, {"code": "1625", "name": "北三重分行"}, {"code": "1636", "name": "新莊分行"}, {"code": "1647", "name": "永和分行"}, {"code": "1658", "name": "中和分行"}, {"code": "1669", "name": "新店分行"}, {"code": "1670", "name": "淡水分行"}, {"code": "1681", "name": "汐止分行"}, {"code": "1692", "name": "南永和分行"}, {"code": "1706", "name": "西三重分行"}, {"code": "1717", "name": "南三重分行"}, {"code": "1728", "name": "雙和分行"}, {"code": "1739", "name": "新泰分行"}, {"code": "1740", "name": "二重分行"}, {"code": "1751", "name": "板新分行"}, {"code": "1762", "name": "五股分行"}, {"code": "1773", "name": "潭美分行"}, {"code": "1784", "name": "北投分行"}, {"code": "1795", "name": "西湖分行"}, {"code": "1809", "name": "積穗分行"}, {"code": "1821", "name": "福和分行"}, {"code": "1832", "name": "南勢角分行"}, {"code": "1843", "name": "北蘆洲分行"}, {"code": "1854", "name": "蘆洲分行"}, {"code": "1865", "name": "土城分行"}, {"code": "1876", "name": "北新分行"}, {"code": "1898", "name": "天母分行"}, {"code": "1902", "name": "內湖分行"}, {"code": "1913", "name": "樹林分行"}, {"code": "1924", "name": "樟樹灣分行"}, {"code": "1935", "name": "泰山分行"}, {"code": "1946", "name": "三峽分行"}, {"code": "1957", "name": "文山分行"}, {"code": "1968", "name": "鶯歌分行"}, {"code": "1979", "name": "北新莊分行"}, {"code": "1980", "name": "北土城分行"}, {"code": "1991", "name": "林口站前分行"}, {"code": "2002", "name": "基隆分行"}, {"code": "2013", "name": "基隆港口分行"}, {"code": "2116", "name": "七堵分行"}, {"code": "2208", "name": "羅東分行"}, {"code": "2219", "name": "宜蘭分行"}, {"code": "2404", "name": "桃園分行"}, {"code": "2415", "name": "中壢分行"}, {"code": "2426", "name": "楊梅分行"}, {"code": "2437", "name": "壢昌分行"}, {"code": "2448", "name": "北桃園分行"}, {"code": "2459", "name": "南崁分行"}, {"code": "2460", "name": "平鎮分行"}, {"code": "2471", "name": "八德分行"}, {"code": "2482", "name": "龜山分行"}, {"code": "2493", "name": "龍潭分行"}, {"code": "2507", "name": "大溪分行"}, {"code": "2518", "name": "內壢分行"}, {"code": "2529", "name": "林口分行"}, {"code": "2600", "name": "觀音分行"}, {"code": "2622", "name": "大園分行"}, {"code": "2688", "name": "青埔分行"}, {"code": "3009", "name": "新竹分行"}, {"code": "3010", "name": "竹東分行"}, {"code": "3021", "name": "竹科分行"}, {"code": "3102", "name": "新豐分行"}, {"code": "3135", "name": "六家分行"}, {"code": "3205", "name": "竹南分行"}, {"code": "3216", "name": "頭份分行"}, {"code": "3227", "name": "苗栗分行"}, {"code": "3238", "name": "竹北分行"}, {"code": "3515", "name": "大眾分行"}, {"code": "4006", "name": "豐原分行"}, {"code": "4017", "name": "東勢分行"}, {"code": "4028", "name": "清水分行"}, {"code": "4039", "name": "西豐原分行"}, {"code": "4202", "name": "台中分行"}, {"code": "4224", "name": "南台中分行"}, {"code": "4235", "name": "北台中分行"}, {"code": "4246", "name": "台中港路分行"}, {"code": "4257", "name": "大里分行"}, {"code": "4268", "name": "水湳分行"}, {"code": "4279", "name": "五權分行"}, {"code": "4291", "name": "大甲分行"}, {"code": "4305", "name": "太平分行"}, {"code": "4316", "name": "中科分行"}, {"code": "4512", "name": "沙鹿分行"}, {"code": "5003", "name": "草屯分行"}, {"code": "5014", "name": "南投分行"}, {"code": "5209", "name": "彰化分行"}, {"code": "5210", "name": "和美分行"}, {"code": "5221", "name": "員林分行"}, {"code": "5232", "name": "鹿港分行"}, {"code": "5243", "name": "溪湖分行"}, {"code": "5405", "name": "斗六分行"}, {"code": "5416", "name": "虎尾分行"}, {"code": "5427", "name": "西螺分行"}, {"code": "6000", "name": "嘉義分行"}, {"code": "6011", "name": "嘉南分行"}, {"code": "6022", "name": "朴子分行"}, {"code": "6206", "name": "新營分行"}, {"code": "6217", "name": "麻豆分行"}, {"code": "6228", "name": "永康分行"}, {"code": "6402", "name": "台南分行"}, {"code": "6424", "name": "東台南分行"}, {"code": "6435", "name": "西台南分行"}, {"code": "6446", "name": "北台南分行"}, {"code": "6457", "name": "南都分行"}, {"code": "6468", "name": "安南分行"}, {"code": "6479", "name": "仁德分行"}, {"code": "6480", "name": "新市分行"}, {"code": "6815", "name": "金華分行"}, {"code": "7007", "name": "高雄分行"}, {"code": "7018", "name": "東苓分行"}, {"code": "7029", "name": "新興分行"}, {"code": "7030", "name": "高雄三民分行"}, {"code": "7041", "name": "苓雅分行"}, {"code": "7052", "name": "前鎮分行"}, {"code": "7063", "name": "高雄博愛分行"}, {"code": "7074", "name": "南高雄分行"}, {"code": "7085", "name": "東高雄分行"}, {"code": "7096", "name": "大昌分行"}, {"code": "7100", "name": "北高雄分行"}, {"code": "7111", "name": "楠梓分行"}, {"code": "7122", "name": "左營分行"}, {"code": "7199", "name": "岡山分行"}, {"code": "7203", "name": "鳳山分行"}, {"code": "7214", "name": "路竹分行"}, {"code": "7225", "name": "仁武分行"}, {"code": "7513", "name": "籬仔內分行"}, {"code": "7524", "name": "五甲分行"}, {"code": "7535", "name": "光華分行"}, {"code": "7605", "name": "小港分行"}, {"code": "7650", "name": "高雄桂林分行"}, {"code": "8004", "name": "屏東分行"}, {"code": "8015", "name": "內埔分行"}, {"code": "8026", "name": "潮州分行"}, {"code": "8130", "name": "佳冬分行"}, {"code": "8200", "name": "花蓮分行"}, {"code": "8303", "name": "台東分行"}, {"code": "8886", "name": "營運總部分行"}
        ]
      },
      {
        "code": "009",
        "name": "彰化商業銀行",
        "branches": [
          {"code": "2200", "name": "總行營業部"}, {"code": "3003", "name": "吉林分行"}, {"code": "3010", "name": "城內分行"}, {"code": "4004", "name": "北台中分行"}, {"code": "4011", "name": "南台中分行"}, {"code": "4028", "name": "北屯分行"}, {"code": "4035", "name": "水湳分行"}, {"code": "4042", "name": "南屯分行"}, {"code": "4059", "name": "台中分行"}, {"code": "4108", "name": "基隆分行"}, {"code": "4115", "name": "仁愛分行"}, {"code": "4122", "name": "東基隆分行"}, {"code": "4202", "name": "宜蘭分行"}, {"code": "4219", "name": "羅東分行"}, {"code": "5005", "name": "北門分行"}, {"code": "5012", "name": "台北分行"}, {"code": "5029", "name": "萬華分行"}, {"code": "5036", "name": "西門分行"}, {"code": "5043", "name": "永樂分行"}, {"code": "5050", "name": "建成分行"}, {"code": "5067", "name": "大同分行"}, {"code": "5074", "name": "承德分行"}, {"code": "5081", "name": "中山北路分行"}, {"code": "5109", "name": "東門分行"}, {"code": "5116", "name": "古亭分行"}, {"code": "5123", "name": "五分埔分行"}, {"code": "5130", "name": "大安分行"}, {"code": "5147", "name": "城東分行"}, {"code": "5154", "name": "中崙分行"}, {"code": "5161", "name": "雙園分行"}, {"code": "5178", "name": "士林分行"}, {"code": "5185", "name": "總部分行"}, {"code": "5192", "name": "松山分行"}, {"code": "5203", "name": "忠孝東路分行"}, {"code": "5210", "name": "信義分行"}, {"code": "5227", "name": "東台北分行"}, {"code": "5234", "name": "民生分行"}, {"code": "5241", "name": "西松分行"}, {"code": "5258", "name": "復興分行"}, {"code": "5265", "name": "台北世貿中心分行"}, {"code": "5272", "name": "敦化分行"}, {"code": "5289", "name": "建國分行"}, {"code": "5296", "name": "內湖分行"}, {"code": "5307", "name": "天母分行"}, {"code": "5314", "name": "中正分行"}, {"code": "5321", "name": "仁和分行"}, {"code": "5338", "name": "永春分行"}, {"code": "5345", "name": "光隆分行"}, {"code": "5352", "name": "木柵分行"}, {"code": "5369", "name": "新湖分行"}, {"code": "5376", "name": "東湖分行"}, {"code": "5383", "name": "南港科學園區分行"}, {"code": "5390", "name": "北投分行"}, {"code": "5401", "name": "和平分行"}, {"code": "5418", "name": "東興分行"}, {"code": "5425", "name": "龍潭分行"}, {"code": "5432", "name": "汐科分行"}, {"code": "5456", "name": "新樹分行"}, {"code": "5463", "name": "立德分行"}, {"code": "5470", "name": "泰山分行"}, {"code": "5487", "name": "副都心分行"}, {"code": "5494", "name": "南新莊分行"}, {"code": "5505", "name": "三重埔分行"}, {"code": "5512", "name": "北三重埔分行"}, {"code": "5529", "name": "新店分行"}, {"code": "5536", "name": "永和分行"}, {"code": "5543", "name": "瑞芳分行"}, {"code": "5550", "name": "新莊分行"}, {"code": "5567", "name": "樹林分行"}, {"code": "5574", "name": "板橋分行"}, {"code": "5581", "name": "三峽分行"}, {"code": "5598", "name": "福和分行"}, {"code": "5609", "name": "光復分行"}, {"code": "5623", "name": "北新分行"}, {"code": "5630", "name": "南三重分行"}, {"code": "5647", "name": "中和分行"}, {"code": "5654", "name": "西三重分行"}, {"code": "5661", "name": "汐止分行"}, {"code": "5678", "name": "雙和分行"}, {"code": "5685", "name": "淡水分行"}, {"code": "5692", "name": "楊梅分行"}, {"code": "5703", "name": "桃園分行"}, {"code": "5710", "name": "中壢分行"}, {"code": "5727", "name": "新竹分行"}, {"code": "5734", "name": "竹東分行"}, {"code": "5741", "name": "苗栗分行"}, {"code": "5758", "name": "新竹科學園區分行"}, {"code": "5765", "name": "北中壢分行"}, {"code": "5772", "name": "八德分行"}, {"code": "5789", "name": "竹南分行"}, {"code": "5796", "name": "南崁分行"}, {"code": "5807", "name": "苑裡分行"}, {"code": "5814", "name": "大甲分行"}, {"code": "5821", "name": "清水分行"}, {"code": "5838", "name": "豐原分行"}, {"code": "5845", "name": "東勢分行"}, {"code": "5852", "name": "霧峰分行"}, {"code": "5869", "name": "大雅分行"}, {"code": "5876", "name": "沙鹿分行"}, {"code": "5890", "name": "太平分行"}, {"code": "5901", "name": "草屯分行"}, {"code": "5918", "name": "南投分行"}, {"code": "5925", "name": "埔里分行"}, {"code": "5932", "name": "水裡坑分行"}, {"code": "5963", "name": "大肚分行"}, {"code": "5970", "name": "青埔分行"}, {"code": "5987", "name": "竹北分行"}, {"code": "6006", "name": "彰化分行"}, {"code": "6013", "name": "鹿港分行"}, {"code": "6020", "name": "員林分行"}, {"code": "6037", "name": "溪湖分行"}, {"code": "6044", "name": "北斗分行"}, {"code": "6051", "name": "西螺分行"}, {"code": "6068", "name": "和美分行"}, {"code": "6075", "name": "大里分行"}, {"code": "6099", "name": "二林分行"}, {"code": "6100", "name": "斗六分行"}, {"code": "6117", "name": "斗南分行"}, {"code": "6124", "name": "虎尾分行"}, {"code": "6131", "name": "北港分行"}, {"code": "6204", "name": "大林分行"}, {"code": "6211", "name": "嘉義分行"}, {"code": "6228", "name": "東嘉義分行"}, {"code": "6235", "name": "新營分行"}, {"code": "6242", "name": "永康分行"}, {"code": "6266", "name": "歸仁分行"}, {"code": "6402", "name": "台南分行"}, {"code": "6419", "name": "延平分行"}, {"code": "6426", "name": "西台南分行"}, {"code": "6433", "name": "東台南分行"}, {"code": "6440", "name": "南台南分行"}, {"code": "6457", "name": "安南分行"}, {"code": "6506", "name": "旗山分行"}, {"code": "6513", "name": "岡山分行"}, {"code": "6520", "name": "鳳山分行"}, {"code": "8119", "name": "高雄分行"}, {"code": "8126", "name": "七賢分行"}, {"code": "8133", "name": "鹽埕分行"}, {"code": "8140", "name": "東高雄分行"}, {"code": "8157", "name": "南高雄分行"}, {"code": "8164", "name": "北高雄分行"}, {"code": "8171", "name": "三民分行"}, {"code": "8195", "name": "前鎮分行"}, {"code": "8206", "name": "九如路分行"}, {"code": "8213", "name": "新興分行"}, {"code": "8220", "name": "苓雅分行"}, {"code": "8237", "name": "大順分行"}, {"code": "8244", "name": "博愛分行"}, {"code": "8251", "name": "左營分行"}, {"code": "8300", "name": "屏東分行"}, {"code": "8317", "name": "東港分行"}, {"code": "8324", "name": "潮州分行"}, {"code": "8348", "name": "恆春分行"}, {"code": "8404", "name": "花蓮分行"}, {"code": "8508", "name": "台東分行"}, {"code": "9269", "name": "思源分行"}, {"code": "9283", "name": "土城分行"}, {"code": "9290", "name": "北桃園分行"}, {"code": "9301", "name": "新明分行"}, {"code": "9318", "name": "埔心分行"}, {"code": "9332", "name": "西屯分行"}, {"code": "9349", "name": "大發分行"}, {"code": "9356", "name": "東林口分行"}, {"code": "9363", "name": "新林口分行"}, {"code": "9523", "name": "土庫分行"}, {"code": "9547", "name": "路竹分行"}, {"code": "9554", "name": "蘇澳分行"}, {"code": "9561", "name": "北台南分行"}, {"code": "9603", "name": "潭子分行"}, {"code": "9610", "name": "北嘉義分行"}, {"code": "9627", "name": "北新竹分行"}, {"code": "9634", "name": "建興分行"}, {"code": "9641", "name": "三和路分行"}, {"code": "9658", "name": "吉成分行"}, {"code": "9689", "name": "林口分行"}, {"code": "9696", "name": "江翠分行"}, {"code": "9714", "name": "長安東路分行"}, {"code": "9721", "name": "晴光分行"}, {"code": "9738", "name": "大直分行"}, {"code": "9752", "name": "松江分行"}, {"code": "9790", "name": "西內湖分行"}, {"code": "9801", "name": "南港分行"}, {"code": "9818", "name": "中港分行"}, {"code": "9832", "name": "蘆洲分行"}, {"code": "9849", "name": "中華路分行"}
        ]
      },
      {
        "code": "011",
        "name": "上海商業儲蓄銀行",
        "branches": [
          {"code": "0026", "name": "營業部"}, {"code": "0037", "name": "儲蓄部"}, {"code": "0048", "name": "高雄分行"}, {"code": "0060", "name": "城中分行"}, {"code": "0082", "name": "台中分行"}, {"code": "0093", "name": "東台北分行"}, {"code": "0107", "name": "台南分行"}, {"code": "0118", "name": "桃園分行"}, {"code": "0129", "name": "北高雄分行"}, {"code": "0130", "name": "三重分行"}, {"code": "0141", "name": "板橋分行"}, {"code": "0152", "name": "永和分行"}, {"code": "0163", "name": "員林分行"}, {"code": "0185", "name": "信義分行"}, {"code": "0196", "name": "民生分行"}, {"code": "0200", "name": "忠孝分行"}, {"code": "0211", "name": "龍山分行"}, {"code": "0222", "name": "內湖分行"}, {"code": "0233", "name": "中山分行"}, {"code": "0244", "name": "仁愛分行"}, {"code": "0255", "name": "新莊分行"}, {"code": "0266", "name": "中壢分行"}, {"code": "0288", "name": "松山分行"}, {"code": "0299", "name": "新店分行"}, {"code": "0303", "name": "前金分行"}, {"code": "0314", "name": "松南分行"}, {"code": "0325", "name": "蘆洲分行"}, {"code": "0336", "name": "中和分行"}, {"code": "0347", "name": "新竹分行"}, {"code": "0358", "name": "中港分行"}, {"code": "0369", "name": "士林分行"}, {"code": "0370", "name": "東台南分行"}, {"code": "0381", "name": "永康分行"}, {"code": "0392", "name": "北三重分行"}, {"code": "0406", "name": "南京東路分行"}, {"code": "0417", "name": "大里分行"}, {"code": "0428", "name": "土城分行"}, {"code": "0439", "name": "世貿分行"}, {"code": "0440", "name": "承德分行"}, {"code": "0451", "name": "汐止分行"}, {"code": "0462", "name": "屏東分行"}, {"code": "0473", "name": "三民分行"}, {"code": "0484", "name": "華江分行"}, {"code": "0495", "name": "豐原分行"}, {"code": "0509", "name": "鳳山分行"}, {"code": "0510", "name": "天母分行"}, {"code": "0521", "name": "樹林分行"}, {"code": "0532", "name": "基隆分行"}, {"code": "0543", "name": "楊梅分行"}, {"code": "0554", "name": "內湖科技園區分行"}, {"code": "0565", "name": "北中和分行"}, {"code": "0576", "name": "西湖分行"}, {"code": "0598", "name": "二重分行"}, {"code": "0602", "name": "延平分行"}, {"code": "0613", "name": "南崁分行"}, {"code": "0624", "name": "南港分行"}, {"code": "0635", "name": "北新竹分行"}, {"code": "0657", "name": "宜蘭分行"}, {"code": "0668", "name": "文山分行"}, {"code": "0680", "name": "敦北分行"}, {"code": "0691", "name": "東高雄分行"}, {"code": "0705", "name": "竹北分行"}, {"code": "0716", "name": "松江分行"}, {"code": "0727", "name": "市政分行"}, {"code": "0738", "name": "觀音分行"}, {"code": "0749", "name": "北桃園分行"}, {"code": "0750", "name": "丹鳳分行"}, {"code": "0761", "name": "北新莊分行"}, {"code": "0772", "name": "南屯分行"}, {"code": "0794", "name": "林口分行"}, {"code": "0808", "name": "竹科分行"}, {"code": "0819", "name": "永吉分行"}, {"code": "0831", "name": "南科分行"}, {"code": "0842", "name": "苗栗分行"}
        ]
      },
      {
        "code": "012",
        "name": "台北富邦商業銀行",
        "branches": [
          {"code": "2009", "name": "營業部"}, {"code": "2032", "name": "長安東路分行"}, {"code": "2102", "name": "公庫處"}, {"code": "2205", "name": "城東分行"}, {"code": "3006", "name": "士林分行"}, {"code": "3017", "name": "士東分行"}, {"code": "3039", "name": "玉成分行"}, {"code": "3040", "name": "福港分行"}, {"code": "3051", "name": "忠孝分行"}, {"code": "3109", "name": "延平分行"}, {"code": "3202", "name": "木柵分行"}, {"code": "3408", "name": "八德分行"}, {"code": "3419", "name": "松南分行"}, {"code": "3420", "name": "永吉分行"}, {"code": "3501", "name": "中山分行"}, {"code": "3604", "name": "北投分行"}, {"code": "3615", "name": "石牌分行"}, {"code": "3707", "name": "大安分行"}, {"code": "3800", "name": "大同分行"}, {"code": "3903", "name": "古亭分行"}, {"code": "4003", "name": "雙園分行"}, {"code": "4014", "name": "萬華分行"}, {"code": "4106", "name": "建成分行"}, {"code": "4117", "name": "市府分行"}, {"code": "4209", "name": "南港分行"}, {"code": "4302", "name": "景美分行"}, {"code": "4313", "name": "興隆分行"}, {"code": "4405", "name": "內湖分行"}, {"code": "4427", "name": "文德分行"}, {"code": "4542", "name": "民生分行"}, {"code": "4601", "name": "信義分行"}, {"code": "4612", "name": "莊敬分行"}, {"code": "4623", "name": "東門分行"}, {"code": "4704", "name": "松江分行"}, {"code": "4807", "name": "和平分行"}, {"code": "5103", "name": "南門分行"}, {"code": "5309", "name": "西松分行"}, {"code": "5505", "name": "桂林分行"}, {"code": "5701", "name": "沙鹿分行"}, {"code": "5804", "name": "臨沂分行"}, {"code": "5907", "name": "中崙分行"}, {"code": "6007", "name": "基隆路分行"}, {"code": "6100", "name": "師大分行"}, {"code": "6203", "name": "永春分行"}, {"code": "6214", "name": "懷生分行"}, {"code": "6306", "name": "民權分行"}, {"code": "6502", "name": "社子分行"}, {"code": "6605", "name": "港都分行"}, {"code": "6683", "name": "西湖分行"}, {"code": "6719", "name": "中港分行"}, {"code": "6720", "name": "新莊分行"}, {"code": "6731", "name": "桃園分行"}, {"code": "6742", "name": "台南分行"}, {"code": "6775", "name": "埔墘分行"}, {"code": "6786", "name": "北中壢分行"}, {"code": "6797", "name": "三重分行"}, {"code": "6801", "name": "豐原分行"}, {"code": "6812", "name": "中和分行"}, {"code": "6823", "name": "鼓山分行"}, {"code": "6845", "name": "風城分行"}, {"code": "6856", "name": "彰化分行"}, {"code": "6867", "name": "東湖分行"}, {"code": "6878", "name": "永和分行"}, {"code": "6889", "name": "岡山分行"}, {"code": "6890", "name": "台北一０一分行"}, {"code": "7026", "name": "南京東路分行"}, {"code": "7037", "name": "敦北分行"}, {"code": "7048", "name": "仁愛分行"}, {"code": "7059", "name": "高雄分行"}, {"code": "7060", "name": "中正分行"}, {"code": "7071", "name": "台中分行"}, {"code": "7093", "name": "松高分行"}, {"code": "7107", "name": "土城分行"}, {"code": "7118", "name": "東寧分行"}, {"code": "7129", "name": "鳳山分行"}, {"code": "7130", "name": "中壢分行"}, {"code": "7152", "name": "安和分行"}, {"code": "7163", "name": "正義分行"}, {"code": "7174", "name": "大湳分行"}, {"code": "7185", "name": "嘉義分行"}, {"code": "7211", "name": "板橋分行"}, {"code": "7222", "name": "北台中分行"}, {"code": "7233", "name": "三民分行"}, {"code": "7244", "name": "建國分行"}, {"code": "7255", "name": "新竹分行"}, {"code": "7266", "name": "新店分行"}, {"code": "7277", "name": "天母分行"}, {"code": "7288", "name": "汐止分行"}, {"code": "7303", "name": "永康分行"}, {"code": "7314", "name": "城中分行"}, {"code": "7347", "name": "新營分行"}, {"code": "7358", "name": "屏東分行"}, {"code": "7369", "name": "前鎮分行"}, {"code": "7370", "name": "敦南分行"}, {"code": "7381", "name": "保生分行"}, {"code": "7392", "name": "員林分行"}, {"code": "7406", "name": "羅東分行"}, {"code": "7417", "name": "瑞湖分行"}, {"code": "7451", "name": "花蓮分行"}, {"code": "7462", "name": "竹北分行"}, {"code": "7473", "name": "南台中分行"}, {"code": "7484", "name": "博愛分行"}, {"code": "7495", "name": "蘆洲分行"}, {"code": "7509", "name": "華江分行"}, {"code": "7510", "name": "大直分行"}, {"code": "7521", "name": "樹林分行"}, {"code": "7532", "name": "基隆分行"}, {"code": "7543", "name": "竹科分行"}, {"code": "7554", "name": "林口分行"}, {"code": "7565", "name": "新板分行"}, {"code": "7576", "name": "三峽分行"}, {"code": "7587", "name": "南崁分行"}, {"code": "7598", "name": "東台南分行"}, {"code": "7602", "name": "左營分行"}, {"code": "7613", "name": "大里分行"}, {"code": "7624", "name": "得和分行"}, {"code": "7635", "name": "斗六分行"}, {"code": "7646", "name": "國美分行"}, {"code": "7657", "name": "南勢角分行"}, {"code": "7668", "name": "北屯分行"}, {"code": "7679", "name": "淡水分行"}, {"code": "7680", "name": "西屯分行"}, {"code": "7691", "name": "北新分行"}, {"code": "7705", "name": "市政分行"}, {"code": "7716", "name": "北新莊分行"}, {"code": "7727", "name": "大雅分行"}, {"code": "7738", "name": "新北大道分行"}, {"code": "7750", "name": "東林口分行"}, {"code": "7761", "name": "南桃園分行"}, {"code": "7772", "name": "信安分行"}, {"code": "7783", "name": "光明分行"}, {"code": "7794", "name": "宜蘭分行"}, {"code": "7808", "name": "台東分行"}, {"code": "7819", "name": "北台南分行"}, {"code": "7820", "name": "竹南分行"}, {"code": "7831", "name": "虎尾分行"}, {"code": "7853", "name": "竹東分行"}, {"code": "8023", "name": "苗栗分行"}, {"code": "8034", "name": "善化分行"}, {"code": "8056", "name": "青埔分行"}, {"code": "8078", "name": "東城分行"}, {"code": "8115", "name": "中平分行"}, {"code": "8148", "name": "中路分行"}, {"code": "8160", "name": "板南分行"}, {"code": "8171", "name": "世貿分行"}, {"code": "8229", "name": "集賢分行"}, {"code": "8230", "name": "學士分行"}, {"code": "8241", "name": "雙和分行"}, {"code": "8263", "name": "東樹林分行"}, {"code": "8274", "name": "北桃園分行"}, {"code": "8285", "name": "竹城分行"}, {"code": "8296", "name": "敦化分行"}, {"code": "8300", "name": "北高雄分行"}, {"code": "8322", "name": "頭份分行"}, {"code": "8333", "name": "水湳分行"}, {"code": "8366", "name": "福科分行"}, {"code": "8388", "name": "南海分行"}, {"code": "8399", "name": "二林分行"}, {"code": "8403", "name": "大園分行"}, {"code": "8414", "name": "行善分行"}, {"code": "8436", "name": "安平分行"}, {"code": "8458", "name": "央北分行"}, {"code": "8470", "name": "昆陽分行"}, {"code": "8481", "name": "北蘆洲分行"}, {"code": "8517", "name": "重慶南路分行"}, {"code": "8562", "name": "公益分行"}, {"code": "8584", "name": "苓雅分行"}, {"code": "8595", "name": "七賢分行"}, {"code": "8609", "name": "思源分行"}, {"code": "8610", "name": "東嘉義分行"}
        ]
      },
      {
        "code": "013",
        "name": "國泰世華商業銀行",
        "branches": [
          {"code": "0017", "name": "館前分行"}, {"code": "0028", "name": "環球交易服務部"}, {"code": "0039", "name": "南京東路分行"}, {"code": "0051", "name": "高雄分行"}, {"code": "0062", "name": "台中分行"}, {"code": "0073", "name": "台北分行"}, {"code": "0095", "name": "永和分行"}, {"code": "0109", "name": "台南分行"}, {"code": "0110", "name": "忠孝分行"}, {"code": "0121", "name": "天母分行"}, {"code": "0132", "name": "西台中分行"}, {"code": "0143", "name": "東高雄分行"}, {"code": "0154", "name": "信義分行"}, {"code": "0165", "name": "光復分行"}, {"code": "0176", "name": "板橋分行"}, {"code": "0187", "name": "復興分行"}, {"code": "0198", "name": "民權分行"}, {"code": "0202", "name": "大安分行"}, {"code": "0213", "name": "三重分行"}, {"code": "0224", "name": "中壢分行"}, {"code": "0235", "name": "員林分行"}, {"code": "0246", "name": "新店分行"}, {"code": "0257", "name": "新莊分行"}, {"code": "0268", "name": "鳳山分行"}, {"code": "0279", "name": "安和分行"}, {"code": "0280", "name": "松江分行"}, {"code": "0291", "name": "苓雅分行"}, {"code": "0305", "name": "古亭分行"}, {"code": "0316", "name": "建成分行"}, {"code": "0327", "name": "東門分行"}, {"code": "0349", "name": "桃園分行"}, {"code": "0350", "name": "豐原分行"}, {"code": "0361", "name": "嘉義分行"}, {"code": "0372", "name": "松山分行"}, {"code": "0383", "name": "前金分行"}, {"code": "0394", "name": "北三重分行"}, {"code": "0408", "name": "新竹分行"}, {"code": "0419", "name": "永康分行"}, {"code": "0420", "name": "中山分行"}, {"code": "0431", "name": "埔墘分行"}, {"code": "0442", "name": "新生分行"}, {"code": "0453", "name": "中和分行"}, {"code": "0464", "name": "清水分行"}, {"code": "0475", "name": "彰化分行"}, {"code": "0486", "name": "內科分行"}, {"code": "0497", "name": "中正分行"}, {"code": "0501", "name": "五權分行"}, {"code": "0512", "name": "東台南分行"}, {"code": "0523", "name": "新興分行"}, {"code": "0534", "name": "敦南分行"}, {"code": "0545", "name": "後埔分行"}, {"code": "0556", "name": "蘆洲分行"}, {"code": "0567", "name": "西門分行"}, {"code": "0578", "name": "三民分行"}, {"code": "0590", "name": "前鎮分行"}, {"code": "0604", "name": "土城分行"}, {"code": "0615", "name": "南高雄分行"}, {"code": "0626", "name": "大同分行"}, {"code": "0637", "name": "成功分行"}, {"code": "0648", "name": "中港分行"}, {"code": "0659", "name": "世貿分行"}, {"code": "0660", "name": "北桃園分行"}, {"code": "0671", "name": "善化分行"}, {"code": "0682", "name": "士林分行"}, {"code": "0693", "name": "雙和分行"}, {"code": "0707", "name": "二重分行"}, {"code": "0729", "name": "花蓮分行"}, {"code": "0730", "name": "內湖分行"}, {"code": "0741", "name": "華江分行"}, {"code": "0752", "name": "竹科分行"}, {"code": "0763", "name": "南門分行"}, {"code": "0774", "name": "八德分行"}, {"code": "0785", "name": "永春分行"}, {"code": "0796", "name": "萬華分行"}, {"code": "1014", "name": "屏東分行"}, {"code": "1025", "name": "台東分行"}, {"code": "1036", "name": "文山分行"}, {"code": "1047", "name": "新樹分行"}, {"code": "1058", "name": "宜蘭分行"}, {"code": "1069", "name": "南港分行"}, {"code": "1070", "name": "斗六分行"}, {"code": "1081", "name": "南投分行"}, {"code": "1092", "name": "汐止分行"}, {"code": "1106", "name": "大直分行"}, {"code": "1117", "name": "左營分行"}, {"code": "1128", "name": "新營分行"}, {"code": "1139", "name": "大甲分行"}, {"code": "1140", "name": "苗栗分行"}, {"code": "1151", "name": "北投分行"}, {"code": "1162", "name": "臨安分行"}, {"code": "1173", "name": "思源分行"}, {"code": "1184", "name": "華山分行"}, {"code": "1195", "name": "東湖分行"}, {"code": "1209", "name": "岡山分行"}, {"code": "1210", "name": "臨沂分行"}, {"code": "1221", "name": "新湖分行"}, {"code": "1232", "name": "中崙分行"}, {"code": "1243", "name": "基隆分行"}, {"code": "1254", "name": "樹林分行"}, {"code": "1276", "name": "淡水分行"}, {"code": "1287", "name": "連城分行"}, {"code": "1298", "name": "石牌分行"}, {"code": "1302", "name": "南內湖分行"}, {"code": "1313", "name": "景美分行"}, {"code": "1324", "name": "寶橋分行"}, {"code": "1335", "name": "丹鳳分行"}, {"code": "1346", "name": "林口分行"}, {"code": "1357", "name": "南崁分行"}, {"code": "1368", "name": "東林口分行"}, {"code": "1379", "name": "大湳分行"}, {"code": "1380", "name": "松勤分行"}, {"code": "1391", "name": "六家分行"}, {"code": "1405", "name": "三峽分行"}, {"code": "1416", "name": "青埔分行"}, {"code": "2011", "name": "仁愛分行"}, {"code": "2022", "name": "大昌分行"}, {"code": "2044", "name": "篤行分行"}, {"code": "2055", "name": "板東分行"}, {"code": "2066", "name": "桃興分行"}, {"code": "2099", "name": "嘉泰分行"}, {"code": "2103", "name": "竹城分行"}, {"code": "2114", "name": "忠誠分行"}, {"code": "2125", "name": "敦化分行"}, {"code": "2147", "name": "新泰分行"}, {"code": "2158", "name": "文心分行"}, {"code": "2169", "name": "福和分行"}, {"code": "2170", "name": "四維分行"}, {"code": "2181", "name": "營業部"}, {"code": "2206", "name": "重新分行"}, {"code": "2217", "name": "北中壢分行"}, {"code": "2228", "name": "城東分行"}, {"code": "2239", "name": "建國分行"}, {"code": "2251", "name": "學府分行"}, {"code": "2262", "name": "北新分行"}, {"code": "2273", "name": "信安分行"}, {"code": "2295", "name": "文德分行"}, {"code": "2321", "name": "公益分行"}, {"code": "2332", "name": "水湳分行"}, {"code": "2343", "name": "市政分行"}, {"code": "2354", "name": "東台中分行"}, {"code": "2365", "name": "昌平分行"}, {"code": "2376", "name": "健行分行"}, {"code": "2398", "name": "西屯分行"}, {"code": "2402", "name": "南屯分行"}, {"code": "2413", "name": "崇德分行"}, {"code": "2457", "name": "頭份分行"}, {"code": "2468", "name": "竹北分行"}, {"code": "2480", "name": "同德分行"}, {"code": "2549", "name": "彰美分行"}, {"code": "2550", "name": "太平分行"}, {"code": "2561", "name": "沙鹿分行"}, {"code": "2583", "name": "大里分行"}, {"code": "2608", "name": "逢甲分行"}, {"code": "2619", "name": "大雅分行"}, {"code": "2620", "name": "潭子分行"}, {"code": "2642", "name": "西松分行"}, {"code": "2653", "name": "蘭雅分行"}, {"code": "2664", "name": "永平分行"}, {"code": "2675", "name": "和平分行"}, {"code": "2686", "name": "慶城分行"}, {"code": "2697", "name": "瑞湖分行"}, {"code": "2701", "name": "文昌分行"}, {"code": "2712", "name": "正義分行"}, {"code": "2723", "name": "新板分行"}, {"code": "2734", "name": "永貞分行"}, {"code": "2778", "name": "明誠分行"}, {"code": "8954", "name": "專區分行"}
        ]
      },
      {
        "code": "016",
        "name": "高雄銀行",
        "branches": [
          {"code": "1017", "name": "營業部"}, {"code": "1028", "name": "公庫部"}, {"code": "1039", "name": "岡山本洲分行"}, {"code": "1040", "name": "國外業務處"}, {"code": "1051", "name": "信託部"}, {"code": "2003", "name": "鳳山分行"}, {"code": "2025", "name": "前金分行"}, {"code": "2036", "name": "三民分行"}, {"code": "2081", "name": "左營分行"}, {"code": "2106", "name": "小港分行"}, {"code": "2117", "name": "桃園分行"}, {"code": "2128", "name": "林口分行"}, {"code": "2139", "name": "右昌分行"}, {"code": "2140", "name": "灣內分行"}, {"code": "2151", "name": "屏東分行"}, {"code": "2162", "name": "桂林分行"}, {"code": "2173", "name": "新莊分行"}, {"code": "2184", "name": "橋頭科學園區分行"}, {"code": "2195", "name": "鼓山分行"}, {"code": "2209", "name": "建國分行"}, {"code": "2210", "name": "九如分行"}, {"code": "2221", "name": "中壢分行"}, {"code": "2232", "name": "草衙分行"}, {"code": "2243", "name": "板橋分行"}, {"code": "2254", "name": "台南分行"}, {"code": "2265", "name": "三多分行"}, {"code": "2276", "name": "大發分行"}, {"code": "2287", "name": "大直分行"}, {"code": "2298", "name": "台中分行"}, {"code": "2313", "name": "旗津簡易型分行"}, {"code": "2324", "name": "南高雄分行"}, {"code": "2335", "name": "大里分行"}, {"code": "2346", "name": "新竹分行"}, {"code": "2357", "name": "市府分行"}, {"code": "2379", "name": "中和分行"}, {"code": "2380", "name": "台北分行"}, {"code": "2405", "name": "成大分行"}, {"code": "2416", "name": "北高雄分行"}, {"code": "2450", "name": "博愛分行"}
        ]
      },
      {
        "code": "017",
        "name": "兆豐國際商業銀行",
        "branches": [
          {"code": "0022", "name": "港都分行"}, {"code": "0033", "name": "楠梓分行"}, {"code": "0044", "name": "台中分行"}, {"code": "0055", "name": "忠孝分行"}, {"code": "0066", "name": "府城分行"}, {"code": "0077", "name": "國外部"}, {"code": "0088", "name": "台北復興分行"}, {"code": "0099", "name": "財富管理處"}, {"code": "0103", "name": "蘭雅分行"}, {"code": "0114", "name": "財務處"}, {"code": "0125", "name": "三重分行"}, {"code": "0136", "name": "新興分行"}, {"code": "0147", "name": "桃園分行"}, {"code": "0158", "name": "中山分行"}, {"code": "0169", "name": "高雄科技園區分行"}, {"code": "0170", "name": "城中分行"}, {"code": "0181", "name": "北彰化分行"}, {"code": "0192", "name": "安和分行"}, {"code": "0206", "name": "竹科新安分行"}, {"code": "0217", "name": "天母分行"}, {"code": "0228", "name": "嘉義分行"}, {"code": "0239", "name": "花蓮分行"}, {"code": "0251", "name": "國際金融業務分行"}, {"code": "0262", "name": "北新竹分行"}, {"code": "0273", "name": "板南分行"}, {"code": "0284", "name": "潭子分行"}, {"code": "0295", "name": "桃園國際機場分行"}, {"code": "0309", "name": "南台北分行"}, {"code": "0310", "name": "敦南分行"}, {"code": "0321", "name": "員林分行"}, {"code": "0343", "name": "永和分行"}, {"code": "0354", "name": "豐原分行"}, {"code": "0365", "name": "民生分行"}, {"code": "0376", "name": "北台中分行"}, {"code": "0387", "name": "亞灣分行"}, {"code": "0398", "name": "中壢分行"}, {"code": "0402", "name": "三民分行"}, {"code": "0413", "name": "新莊分行"}, {"code": "0424", "name": "松南分行"}, {"code": "0435", "name": "大同分行"}, {"code": "0446", "name": "南台中分行"}, {"code": "0457", "name": "鳳山分行"}, {"code": "0468", "name": "新店分行"}, {"code": "0479", "name": "東高雄分行"}, {"code": "0480", "name": "信義分行"}, {"code": "0491", "name": "基隆分行"}, {"code": "0505", "name": "永康分行"}, {"code": "0516", "name": "內湖分行"}, {"code": "0527", "name": "岡山分行"}, {"code": "0538", "name": "屏東分行"}, {"code": "0550", "name": "松山機場分行"}, {"code": "0561", "name": "土城分行"}, {"code": "0572", "name": "大稻埕分行"}, {"code": "0583", "name": "頭份分行"}, {"code": "0594", "name": "苓雅分行"}, {"code": "0608", "name": "沙鹿分行"}, {"code": "0619", "name": "八德分行"}, {"code": "0620", "name": "宜蘭分行"}, {"code": "0631", "name": "斗六分行"}, {"code": "0642", "name": "南投分行"}, {"code": "0653", "name": "東台南分行"}, {"code": "0664", "name": "高雄國際機場分行"}, {"code": "0675", "name": "東內湖分行"}, {"code": "0686", "name": "太平分行"}, {"code": "0697", "name": "中和分行"}, {"code": "0701", "name": "南京東路分行"}, {"code": "0712", "name": "東台中分行"}, {"code": "0723", "name": "北高雄分行"}, {"code": "0745", "name": "南港分行"}, {"code": "0756", "name": "竹南科學園區分行"}, {"code": "0767", "name": "中科分行"}, {"code": "0778", "name": "大甲分行"}, {"code": "0789", "name": "成功簡易型分行"}, {"code": "0790", "name": "金門分行"}, {"code": "0804", "name": "南崁分行"}, {"code": "0815", "name": "中鋼簡易型分行"}, {"code": "0837", "name": "向上分行"}, {"code": "0860", "name": "駐外交部簡易型分行"}, {"code": "1030", "name": "仁武分行"}, {"code": "1166", "name": "高雄漁港簡易型分行"}, {"code": "2015", "name": "金控總部分行"}, {"code": "2026", "name": "台北分行"}, {"code": "2037", "name": "新竹分行"}, {"code": "2048", "name": "中台中分行"}, {"code": "2059", "name": "高雄分行"}, {"code": "2060", "name": "板橋分行"}, {"code": "2071", "name": "桃興分行"}, {"code": "2082", "name": "竹北分行"}, {"code": "2107", "name": "敦化分行"}, {"code": "2129", "name": "嘉興分行"}, {"code": "2130", "name": "台南分行"}, {"code": "2141", "name": "寶成分行"}, {"code": "2152", "name": "竹科竹村分行"}, {"code": "2163", "name": "世貿分行"}, {"code": "2196", "name": "南三重分行"}, {"code": "2200", "name": "南彰化分行"}, {"code": "2266", "name": "大直分行"}, {"code": "2277", "name": "五福分行"}, {"code": "2288", "name": "羅東分行"}, {"code": "2299", "name": "大安分行"}, {"code": "2314", "name": "林口分行"}, {"code": "2325", "name": "后里分行"}, {"code": "2336", "name": "鹿港分行"}, {"code": "2347", "name": "圓山分行"}, {"code": "2358", "name": "新都分行"}, {"code": "2369", "name": "青埔分行"}, {"code": "2370", "name": "內湖科學園區分行"}, {"code": "2381", "name": "雙和分行"}, {"code": "2406", "name": "衡陽分行"}, {"code": "2417", "name": "大里分行"}, {"code": "2428", "name": "台南科學園區分行"}
        ]
      }
    ];

    window.onload = function() { 
        initDateSelects(); 
        setDefaultCoverDate(); 
        calcFees();
        // 初始化銀行選單 (直接使用內建資料，不 fetch)
        initBankDatalist(); 
    };

    // 初始化銀行選單
    function initBankDatalist() {
        const bankList = document.getElementById('bankList');
        bankList.innerHTML = ''; 

        bankData.forEach(bank => {
            const option = document.createElement('option');
            // 格式：012 台北富邦商業銀行
            option.value = `${bank.code} ${bank.name}`; 
            bankList.appendChild(option);
        });

        // 監聽銀行欄位變更，連動更新分行清單
        document.getElementById('bankName').addEventListener('input', updateBranchList);
        
        // ★ 移除點擊清空功能，改為「全選文字」方便使用者修改
        document.getElementById('bankName').addEventListener('click', function() { this.select(); });
        document.getElementById('bankBranch').addEventListener('click', function() { this.select(); });
    }

    // 更新分行選單
    function updateBranchList() {
        const bankInput = document.getElementById('bankName').value;
        const branchList = document.getElementById('branchList');
        const branchInput = document.getElementById('bankBranch');
        
        branchList.innerHTML = '';
        
        // 若正在清空則不動作
        if (!bankInput) {
            branchInput.value = '';
            return;
        }

        // 取得銀行代碼 (切分空白前的字串)
        const bankCode = bankInput.split(' ')[0];
        const selectedBank = bankData.find(b => b.code === bankCode);

        if (selectedBank && selectedBank.branches) {
            branchInput.value = ''; // 換銀行時清空分行欄位
            selectedBank.branches.forEach(branch => {
                const option = document.createElement('option');
                // 格式：7211 板橋分行
                option.value = `${branch.code} ${branch.name}`;
                branchList.appendChild(option);
            });
        }
    }

    /* --- 其他原有功能 --- */

    function initDateSelects() {
        const ids = ['start', 'end', 'cover'];
        ids.forEach(prefix => {
            const y = document.getElementById(prefix+'Year'), m = document.getElementById(prefix+'Month'), d = document.getElementById(prefix+'Day');
            for(let i=113; i<=130; i++) y.add(new Option(i, i));
            for(let i=1; i<=12; i++) m.add(new Option(i<10?'0'+i:i, i<10?'0'+i:i));
            for(let i=1; i<=31; i++) d.add(new Option(i<10?'0'+i:i, i<10?'0'+i:i));
        });
    }
    function setDefaultCoverDate() {
        const t = new Date(), y = t.getFullYear()-1911, m = (t.getMonth()+1).toString().padStart(2,'0'), d = t.getDate().toString().padStart(2,'0');
        const ySel = document.getElementById('coverYear');
        for(let i=0;i<ySel.options.length;i++) if(ySel.options[i].value==y) { ySel.selectedIndex=i; document.getElementById('coverMonth').value=m; document.getElementById('coverDay').value=d; break; }
    }
    function formatMoney(n) { return (n===null||isNaN(n)) ? "0" : n.toLocaleString('en-US'); }
    function numToChi(n) {
        const m=['零','壹','貳','參','肆','伍','陸','柒','捌','玖']; n=parseInt(n); if(isNaN(n)||n===0)return "零";
        let s=""; if(n>=100){s+=m[Math.floor(n/100)]+"佰";n%=100;if(n>0&&n<10)s+="零";} if(n>=10){s+=m[Math.floor(n/10)]+"拾";n%=10;} if(n>0)s+=m[n]; return s;
    }
    function loadFile(u,c) { var x=new XMLHttpRequest(); x.open('GET',u,true); x.responseType='arraybuffer'; x.onload=function(){if(this.status===200)c(null,this.response);else c(new Error(this.status));}; x.send(); }
    
    function nextPage(p) {
        if(p===2) {
            let valid = true;
            let firstError = null;

            const basicFields = ['commName','commAddr','partyB','repName','phone','bankName','bankBranch','acctName','acctNum'];
            basicFields.forEach(id => {
                let e = document.getElementById(id);
                if(!e.value.trim()){
                    e.style.border="2px solid red";
                    valid=false;
                    if(!firstError) firstError = e;
                } else {
                    e.style.border="1px solid #ccc";
                }
            });

            const dateFields = ['startYear','startMonth','startDay','endYear','endMonth','endDay'];
            dateFields.forEach(id => {
                let e = document.getElementById(id);
                if(!e.value) {
                    e.style.border="2px solid red";
                    valid = false;
                    if(!firstError) firstError = e;
                } else {
                    e.style.border="1px solid #999"; 
                }
            });

            if(!valid){ 
                alert("請填寫所有必填欄位 (標示 * 紅色框處)"); 
                if(firstError) firstError.scrollIntoView({behavior:"smooth",block:"center"}); 
                return; 
            }

            const totalMonthlyText = document.getElementById('total_monthly').value; 
            const totalVal = parseInt(totalMonthlyText.replace(/[^\d]/g, '')) || 0;
            
            if (totalVal <= 0) {
                const userConfirmed = confirm("⚠️ 系統偵測到「合計金額」為 0。\n\n• 按「確定」：忽略警告，繼續前往下一步。\n• 按「取消」：留在本頁檢查或修改。");
                if (!userConfirmed) {
                    document.getElementById('total_monthly').scrollIntoView({behavior:"smooth",block:"center"});
                    return;
                }
            }
        }
        document.querySelectorAll('.page').forEach(e=>e.classList.remove('active')); document.getElementById('page'+p).classList.add('active'); window.scrollTo(0,0);
    }

    function prevPage(p) { nextPage(p); }
    function toggleEmailInput() { document.getElementById('emailInputArea').classList.toggle('hidden', !document.getElementById('notify_email').checked); }
    function toggleOtherInput() { document.getElementById('otherInputArea').classList.toggle('hidden', !document.getElementById('notify_other').checked); }
    function toggleSpecialInput() { document.getElementById('specialInputArea').classList.toggle('hidden', !document.querySelector('input[name="specialOpt"][value="2"]').checked); }

    function calcDuration() {
        const sY=parseInt(document.getElementById('startYear').value), sM=parseInt(document.getElementById('startMonth').value), sD=parseInt(document.getElementById('startDay').value);
        const eY=parseInt(document.getElementById('endYear').value), eM=parseInt(document.getElementById('endMonth').value), eD=parseInt(document.getElementById('endDay').value);
        if(!sY||!sM||!sD||!eY||!eM||!eD) return;
        let start=new Date(sY+1911,sM-1,sD), end=new Date(eY+1911,eM-1,eD), dEnd=new Date(end); dEnd.setDate(dEnd.getDate()+1);
        let ys=dEnd.getFullYear()-start.getFullYear(), ms=dEnd.getMonth()-start.getMonth(), ds=dEnd.getDate()-start.getDate();
        if(ds<0){ ms--; ds+=new Date(dEnd.getFullYear(),dEnd.getMonth(),0).getDate(); } if(ms<0){ ys--; ms+=12; }
        document.getElementById('durationResult').value=`共計${numToChi(ys)}年${numToChi(ms)}月${numToChi(ds)}日`;
    }

    function calcFees() {
        let q1=parseInt(document.getElementById('qty_eip_net_1').value)||0, p1=parseInt(document.getElementById('price_eip_net_1').value)||0, s1=q1*p1;
        let q2=parseInt(document.getElementById('qty_eip_net_2').value)||0, p2=parseInt(document.getElementById('price_eip_net_2').value)||0, s2=q2*p2;
        let q3=parseInt(document.getElementById('qty_eip_anno').value)||0, p3=parseInt(document.getElementById('price_eip_anno').value)||0, s3=q3*p3;
        
        document.getElementById('sub_eip_net_1').value="NT$"+formatMoney(s1); 
        document.getElementById('sub_eip_net_2').value="NT$"+formatMoney(s2);
        document.getElementById('sub_eip_anno').value=q3===0?"N/A":"NT$"+formatMoney(s3);
        document.getElementById('total_monthly').value="NT$"+formatMoney(s1+s2+s3);
    }

    function generateContract() {
        loadFile("./template.docx", function(err, content) {
            if(err) { alert("無法讀取 template.docx"); return; }
            try {
                const zip = new PizZip(content);
                const doc = new window.docxtemplater(zip, { paragraphLoop: true, linebreaks: true });
                
                const isRenew = document.querySelector('input[name="contractType"]:checked').value === 'renew';
                const CHECKED="☑", UNCHECKED="☒";
                
                const q1=parseInt(document.getElementById('qty_eip_net_1').value)||0, p1=parseInt(document.getElementById('price_eip_net_1').value)||0;
                const q2=parseInt(document.getElementById('qty_eip_net_2').value)||0, p2=parseInt(document.getElementById('price_eip_net_2').value)||0;
                const q3=parseInt(document.getElementById('qty_eip_anno').value)||0, p3=parseInt(document.getElementById('price_eip_anno').value)||0;
                const sub1=q1*p1, sub2=q2*p2, sub3=q3*p3, totalNet=q1+q2, totalFee=sub1+sub2+sub3;
                
                // 平均單價
                let avgPrice = 0;
                if (totalNet > 0) {
                    avgPrice = Math.round((sub1 + sub2) / totalNet);
                }
                let priceNetStr = "NT$" + formatMoney(avgPrice);

                let specialText = "";
                if(document.querySelector('input[name="specialOpt"][value="2"]').checked) {
                    specialText = (document.getElementById('special_terms_text').value||"").replace(/(\r\n|\n|\r)/gm, "\n").trim();
                }

                // 銀行資料清理：移除代碼與開頭空白 (例如 "012 台北富邦" -> "台北富邦")
                const cleanStr = (s) => s.replace(/^\d+\s+/, '');
                const rawBank = document.getElementById('bankName').value;
                const rawBranch = document.getElementById('bankBranch').value;
                const bankNameOnly = cleanStr(rawBank);
                const branchNameOnly = cleanStr(rawBranch);

                doc.render({
                    check_new: isRenew?UNCHECKED:CHECKED, check_renew: isRenew?CHECKED:UNCHECKED,
                    start_year: document.getElementById('startYear').value, start_month: document.getElementById('startMonth').value, start_day: document.getElementById('startDay').value,
                    end_year: document.getElementById('endYear').value, end_month: document.getElementById('endMonth').value, end_day: document.getElementById('endDay').value,
                    duration_str: document.getElementById('durationResult').value,
                    cover_year: document.getElementById('coverYear').value, cover_month: document.getElementById('coverMonth').value, cover_day: document.getElementById('coverDay').value,
                    comm_name: document.getElementById('commName').value, comm_addr: document.getElementById('commAddr').value,
                    party_b: document.getElementById('partyB').value, rep_name: document.getElementById('repName').value,
                    phone: document.getElementById('phone').value, tax_id: document.getElementById('taxId').value,
                    
                    // 這裡使用處理過的銀行分行名稱
                    bank_info: bankNameOnly + "-" + branchNameOnly,
                    acct_name: document.getElementById('acctName').value, acct_num: document.getElementById('acctNum').value,
                    
                    qty_total_net: totalNet, qty_total_net_chi: totalNet===0?"零":numToChi(totalNet),
                    qty_net_1_chi: q1===0?"N/A":numToChi(q1), loc_net_1: document.getElementById('loc_eip_net_1').value,
                    qty_net_2_chi: q2===0?"N/A":numToChi(q2), loc_net_2: document.getElementById('loc_eip_net_2').value,
                    qty_anno_chi: q3===0?"N/A":numToChi(q3), loc_anno: document.getElementById('loc_eip_anno').value,
                    
                    qty_fee_net_chi: totalNet===0?"N/A":numToChi(totalNet), price_fee_net: priceNetStr, sub_fee_net: "NT$"+formatMoney(sub1+sub2),
                    qty_fee_anno_chi: q3===0?"N/A":numToChi(q3), price_fee_anno: q3===0?"N/A":"NT$"+formatMoney(p3), sub_fee_anno: q3===0?"N/A":"NT$"+formatMoney(sub3),
                    total_monthly: "NT$"+formatMoney(totalFee),

                    check_expiry_1: document.querySelector('input[name="expiryOpt"][value="1"]').checked?CHECKED:UNCHECKED,
                    check_expiry_2: document.querySelector('input[name="expiryOpt"][value="2"]').checked?CHECKED:UNCHECKED,
                    renewal_year_chi: document.getElementById('renewalYear').value,
                    
                    check_notify_line: document.getElementById('notify_line').checked?CHECKED:UNCHECKED,
                    check_notify_paper: document.getElementById('notify_paper').checked?CHECKED:UNCHECKED,
                    check_notify_screen: document.getElementById('notify_screen').checked?CHECKED:UNCHECKED,
                    check_notify_email: document.getElementById('notify_email').checked?CHECKED:UNCHECKED,
                    check_notify_other: document.getElementById('notify_other').checked?CHECKED:UNCHECKED,
                    mail_name_a: document.getElementById('mail_name_a').value, mail_addr_a: document.getElementById('mail_addr_a').value,
                    mail_name_b: document.getElementById('mail_name_b').value, mail_addr_b: document.getElementById('mail_addr_b').value,
                    other_social_app: document.getElementById('other_social_text').value,

                    check_special_1: document.querySelector('input[name="specialOpt"][value="1"]').checked?CHECKED:UNCHECKED,
                    check_special_2: document.querySelector('input[name="specialOpt"][value="2"]').checked?CHECKED:UNCHECKED,
                    special_terms_text: specialText
                });

                saveAs(doc.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}), "合約_"+document.getElementById('commName').value+".docx");
            } catch(e) { console.error(e); alert("生成失敗:"+e.message); }
        });
    }
</script>
</body>
</html>